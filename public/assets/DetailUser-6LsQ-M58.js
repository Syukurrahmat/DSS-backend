import{N as ke,r as K,R as J,j as a,V as ue,F as Fe,i as Ue,a0 as le,U as Q,Y as ce,G as ze,Z as Ve,W as Ne}from"./font-CsN-AIjb.js";import{I as $e,a as He,b as Ke,D as We}from"./DeleteReourceButton-DmYm2oEo.js";import{H as qe}from"./HeadingWithIcon-Bu-0gKVX.js";import{d as he,m as Se,M as me,g as pe,h as ge,i as fe,j as ve,k as xe,o as Pe,u as Oe,p as Ge,r as Ye,A as be,q as Xe,s as Ze,b as _e,f as Je,L as Qe,t as et,v as tt,T as we,w as at,x as nt}from"./app-Dr_tcMC0.js";import{S as te}from"./SectionTitle-CzG0t4XV.js";import{M as st}from"./DTManagedCompanies-ChJnJHE0.js";import{U as rt}from"./DTUserSubscribedNodes-PpahCSAd.js";import{I as ie}from"./inputPassword--y3GXNiL.js";import{u as Re,a as Le,c as ot}from"./common.utils-DYrrUfov.js";import{p as it,n as lt,a as ct,b as dt,d as ut}from"./validator.utils-BRVPdr4m.js";import{u as Ee,c as Te,F as Y,b as ae}from"./index.esm-DItgFQ78.js";import{I as ht}from"./IconCircleCheck-CxXiHA3t.js";import{B as D,F as X,c as de}from"./logo-white-DQaj3O9T.js";import{T as je}from"./chunk-4IH3O7BJ-DxT5X1bM.js";import{I as mt}from"./IconInfoCircle-wtO2SfS3.js";import{I as pt}from"./IconTrash-D67_KFCL.js";import{I as De}from"./IconEdit-ySyhhWg0.js";import{M as gt}from"./chunk-4FCEGNGT-CNeY54QQ.js";import{L as Ce}from"./chunk-K7XRJ7NL-B1FdQTCi.js";import{I as Ie}from"./IconUsersGroup-Bb0bqie7.js";import{I as Me}from"./IconCirclePlus-D7eqtt7O.js";import"./chunk-4YMKQ5D4-COHWJzaz.js";import"./logo-dqb-qIY4.js";import"./index-DhxnfQxf.js";import"./dateFormating-BPYUz-dC.js";import"./TagWithIcon-CsRKeoTP.js";import"./IconExternalLink-BQK1rnJ1.js";import"./commonColumn-68ld58-X.js";/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ft=ke("outline","exclamation-circle","IconExclamationCircle",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M12 9v4",key:"svg-1"}],["path",{d:"M12 16v.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var vt=ke("outline","mail","IconMail",[["path",{d:"M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z",key:"svg-0"}],["path",{d:"M3 7l9 6l9 -6",key:"svg-1"}]]),ne=function(){return ne=Object.assign||function(u){for(var f,v=1,p=arguments.length;v<p;v++){f=arguments[v];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(u[c]=f[c])}return u},ne.apply(this,arguments)},xt=function(u,f){var v={};for(var p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.indexOf(p)<0&&(v[p]=u[p]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,p=Object.getOwnPropertySymbols(u);c<p.length;c++)f.indexOf(p[c])<0&&Object.prototype.propertyIsEnumerable.call(u,p[c])&&(v[p[c]]=u[p[c]]);return v},yt=function(u){var f=u.className,v=u.style,p=u.rules,c=u.value,s=u.valueAgain,I=u.minLength,M=u.maxLength,w=u.rtl,S=u.onChange,P=u.specialCharsRegex,L=P===void 0?/[~`¿¡!#$%\^&*€£@+÷=\-\[\]\\';,/{}\(\)|\\":<>\?\.\_]/g:P,B=u.messages,C=B===void 0?{}:B,W=xt(u,["className","style","rules","value","valueAgain","minLength","maxLength","rtl","onChange","specialCharsRegex","messages"]),j={minLength:{valid:c.length>=(I||100),message:C.minLength||"Password has at least ".concat(I," characters.")},specialChar:{valid:L.test(c),message:C.specialChar||"Password has special characters."},number:{valid:/\d/g.test(c),message:C.number||"Password has a number."},capital:{valid:function(){var x=0;if(c.length===0)return!1;for(;x<c.length;){var y=c.charAt(x);if(y!=y.toLowerCase()){if(y==y.toUpperCase())return!0}x++}return!1}(),message:C.capital||"Password has a capital letter."},match:{valid:c.length>0&&c===s,message:C.match||"Passwords match."},lowercase:{valid:function(){var x=0;if(c.length===0)return!1;for(;x<c.length;){var y=c.charAt(x);if(y!=y.toUpperCase()){if(y==y.toLowerCase())return!0}x++}return!1}(),message:C.lowercase||"Password has a lowercase letter."},letter:{valid:/[a-zA-Z]/g.test(c),message:C.letter||"Password has a letter."},maxLength:{valid:c.length<=(M||16),message:C.maxLength||"Password has no more than ".concat(M," characters.")},notEmpty:{valid:!!(c.length>0&&s&&s.length>0),message:C.notEmpty||"Password fields are not empty."}},k=K.useMemo(function(){return p.filter(function(x){return!!j[x]})},[p]),E=k.every(function(x){return j[x].valid}),F=K.useMemo(function(){return k.filter(function(x){return!j[x].valid})},[c,s,k]);return K.useEffect(function(){typeof S=="function"&&S(E,F)},[E,F]),w&&(f=f?f+" rtl":"rtl"),J.createElement("ul",{className:f,style:ne({margin:0,padding:0},v)},k.map(function(x){var y=j[x],U=y.message,T=y.valid;return J.createElement(bt,ne({key:x,valid:T,iconSize:18,validColor:"#4BCA81",invalidColor:"#FF0033",rtl:w},W),U)}))},bt=function(u){var f=u.valid,v=u.iconSize,p=u.validColor,c=u.invalidColor,s=u.validTextColor,I=u.invalidTextColor,M=u.iconComponents,w=u.hideIcon,S=u.rtl,P=u.children;return J.createElement("li",{className:f?"valid":"invalid",style:{listStyleType:"none",display:"flex",alignItems:"flex-start",margin:"2px 0"}},w?null:M?f?M.ValidIcon:M.InvalidIcon:J.createElement("svg",{className:"checklist-icon",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:v,height:v,viewBox:"0 0 512 512",style:{marginRight:S?0:5,marginLeft:S?5:0}},J.createElement("path",{fill:f?p:c,d:f?"M432 64l-240 240-112-112-80 80 192 192 320-320z":"M507.331 411.33c-0.002-0.002-0.004-0.004-0.006-0.005l-155.322-155.325 155.322-155.325c0.002-0.002 0.004-0.003 0.006-0.005 1.672-1.673 2.881-3.627 3.656-5.708 2.123-5.688 0.912-12.341-3.662-16.915l-73.373-73.373c-4.574-4.573-11.225-5.783-16.914-3.66-2.080 0.775-4.035 1.984-5.709 3.655 0 0.002-0.002 0.003-0.004 0.005l-155.324 155.326-155.324-155.325c-0.002-0.002-0.003-0.003-0.005-0.005-1.673-1.671-3.627-2.88-5.707-3.655-5.69-2.124-12.341-0.913-16.915 3.66l-73.374 73.374c-4.574 4.574-5.784 11.226-3.661 16.914 0.776 2.080 1.985 4.036 3.656 5.708 0.002 0.001 0.003 0.003 0.005 0.005l155.325 155.324-155.325 155.326c-0.001 0.002-0.003 0.003-0.004 0.005-1.671 1.673-2.88 3.627-3.657 5.707-2.124 5.688-0.913 12.341 3.661 16.915l73.374 73.373c4.575 4.574 11.226 5.784 16.915 3.661 2.080-0.776 4.035-1.985 5.708-3.656 0.001-0.002 0.003-0.003 0.005-0.005l155.324-155.325 155.324 155.325c0.002 0.001 0.004 0.003 0.006 0.004 1.674 1.672 3.627 2.881 5.707 3.657 5.689 2.123 12.342 0.913 16.914-3.661l73.373-73.374c4.574-4.574 5.785-11.227 3.662-16.915-0.776-2.080-1.985-4.034-3.657-5.707z"})),J.createElement("span",{style:{paddingTop:2,opacity:f?1:I?void 0:.5,flex:1,color:f?s:I}},P))};const wt=yt;function jt({data:u,...f}){const{isOpen:v,onOpen:p,onClose:c}=he(),s=Re(),[I,M]=K.useState(!1),{userId:w}=u,{handleChange:S,handleBlur:P,values:L,touched:B,errors:C,isSubmitting:W,setSubmitting:j,setFieldError:k,handleSubmit:E,resetForm:F}=Ee({initialValues:{password:"",confirmPassword:"",newPassword:""},validationSchema:Te().shape({password:it.required("Wajib diisi")}),onSubmit:x=>{if(!I){j(!1),s.opss("Masukan kata sandi baru sesuai intruksi");return}const{password:y,newPassword:U}=Le(x);Se.patch(`/users/${w}/`,{password:y,newPassword:U}).then(()=>{s.success("Berhasil Memperharui kata sandi"),c()}).catch(T=>{var z;((z=T.response)==null?void 0:z.status)===401?k("password","Kata sandi salah"):(s.error("Gagal Memperharui kata sandi"),c())}).finally(()=>{j(!1)})}});return a.jsxs(a.Fragment,{children:[a.jsx(D,{onClick:p,...f}),a.jsxs(me,{size:"lg",autoFocus:!1,isOpen:v,onClose:c,onCloseComplete:F,closeOnOverlayClick:!1,children:[a.jsx(pe,{}),a.jsx(ge,{children:a.jsxs("form",{onSubmit:E,className:"my-form",children:[a.jsx(fe,{children:"Perbarui Kata Sandi"}),a.jsx(ve,{children:a.jsxs(ue,{mx:"auto",spacing:"2",maxW:"container.sm",children:[a.jsxs(X,{isInvalid:!!C.password&&B.password,children:[a.jsx(Y,{children:"Kata sandi"}),a.jsx(ie,{id:"password",name:"password",autoComplete:"password",placeholder:"Masukkan kata sandi saat ini",onChange:S,onBlur:P}),a.jsx(ae,{children:C.password})]}),a.jsxs(X,{children:[a.jsx(Y,{children:"Kata sandi Baru"}),a.jsx(ie,{id:"newPassword",name:"newPassword",placeholder:"Masukkan kata sandi",onChange:S})]}),a.jsxs(X,{children:[a.jsx(Y,{children:"Konfirmasi Kata Sandi"}),a.jsx(ie,{id:"confirmPassword",name:"confirmPassword",autoComplete:"new-password",placeholder:"Tulis ulang kata sandi anda",onChange:S})]}),a.jsx(wt,{style:{width:"100%",marginTop:"0.5em"},rules:["minLength","number","capital","match"],minLength:8,value:L.newPassword,valueAgain:L.confirmPassword,onChange:M,messages:{minLength:"Kata sandi harus lebih dari 8 karakter",number:"Kata sandi harus mengandung angka",capital:"Kata sandi harus mengandung huruf kapital",match:"Tulis ulang kata sandi"},iconComponents:{ValidIcon:a.jsx(ht,{color:"green",size:"20",style:{margin:"3px 5px 0 0"}}),InvalidIcon:a.jsx(ft,{color:"red",size:"20",style:{margin:"3px 5px 0 0"}})}})]})}),a.jsxs(xe,{children:[a.jsx(D,{variant:"ghost",onClick:c,children:"Batal"}),a.jsx(D,{isLoading:W,type:"submit",colorScheme:"blue",ml:3,children:"Submit"})]})]})})]})]})}function Ct({data:u,mutate:f,...v}){const{name:p,phone:c,description:s,address:I}=u,M={name:p,phone:c,description:s,address:I},{isOpen:w,onOpen:S,onClose:P}=he(),{id:L}=Pe(),{user:B}=Oe(),C=Re(),W=Ge("/account")?B.userId:L,{values:j,errors:k,touched:E,isSubmitting:F,handleSubmit:x,handleBlur:y,resetForm:U,handleChange:T,setSubmitting:z}=Ee({initialValues:M,validationSchema:Te().shape({name:lt.required("Wajib diisi"),phone:ct.required("Wajib diisi"),address:dt.required("Wajib diisi"),description:ut.nullable()}),onSubmit:ee=>{Le(ee);const V=ot(M,ee);if(Object.keys(V).length===0){C.opss("Belum ada yang disunting"),z(!1);return}Se.patch(`/users/${W}/`,{...V}).then(()=>{C.success("Berhasil Memperharui data"),f(A=>A&&{...A,...V})}).catch(()=>{C.error("Gagal Memperharui data")}).finally(()=>{z(!1),P()})}});return a.jsxs(a.Fragment,{children:[a.jsx(D,{onClick:S,...v}),a.jsxs(me,{size:"lg",autoFocus:!1,isOpen:w,onClose:P,closeOnOverlayClick:!1,children:[a.jsx(pe,{}),a.jsx(ge,{children:a.jsxs("form",{onSubmit:x,className:"my-form",children:[a.jsx(fe,{children:"Sunting Profil"}),a.jsx(ve,{children:a.jsxs(ue,{mx:"auto",spacing:"2",maxW:"container.sm",children:[a.jsxs(X,{isInvalid:!!k.name&&E.name,children:[a.jsx(Y,{children:"Nama"}),a.jsx(de,{id:"name",name:"name",placeholder:"Misal : Suparna",onChange:T,onBlur:y,value:j.name}),a.jsx(ae,{children:k.name})]}),a.jsxs(X,{isInvalid:!!k.phone&&E.phone,children:[a.jsx(Y,{children:"Nomor Telepon"}),a.jsx(de,{id:"phone",name:"phone",placeholder:"Misal : 087812345678",onChange:T,onBlur:y,value:j.phone}),a.jsx(ae,{children:k.phone})]}),a.jsxs(X,{isInvalid:!!k.address&&E.address,children:[a.jsx(Y,{children:"Alamat"}),a.jsx(je,{id:"address",name:"address",placeholder:"Masukkan Alamat Tempat tinggal Pengguna",onChange:T,onBlur:y,value:j.address}),a.jsx(ae,{children:k.address})]}),a.jsxs(X,{isInvalid:!!k.description&&E.description,children:[a.jsx(Y,{children:"Description"}),a.jsx(je,{id:"description",name:"description",placeholder:"Opsional",onChange:T,onBlur:y,value:j.description}),a.jsx(ae,{children:k.description})]})]})}),a.jsxs(xe,{children:[a.jsx(D,{variant:"ghost",onClick:()=>{U(),P()},children:"Batal"}),a.jsx(D,{isLoading:F,type:"submit",colorScheme:"blue",ml:3,children:"Submit"})]})]})})]})]})}var Be={exports:{}};(function(u,f){(function(v,p){u.exports=p(Ye(),K)})(Fe,function(v,p){function c(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var s=c(v),I=c(p);function M(r,d){for(var i=0;i<d.length;i++){var h=d[i];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(r,h.key,h)}}function w(r,d,i){return d in r?Object.defineProperty(r,d,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[d]=i,r}function S(){return(S=Object.assign||function(r){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var h in i)Object.prototype.hasOwnProperty.call(i,h)&&(r[h]=i[h])}return r}).apply(this,arguments)}function P(r,d){var i,h=Object.keys(r);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(r),d&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),h.push.apply(h,i)),h}function L(r){for(var d=1;d<arguments.length;d++){var i=arguments[d]!=null?arguments[d]:{};d%2?P(Object(i),!0).forEach(function(h){w(r,h,i[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):P(Object(i)).forEach(function(h){Object.defineProperty(r,h,Object.getOwnPropertyDescriptor(i,h))})}return r}function B(r){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)})(r)}function C(r,d){return(C=Object.setPrototypeOf||function(i,h){return i.__proto__=h,i})(r,d)}function W(r,d){if(r==null)return{};var i,h=function(n,o){if(n==null)return{};for(var l,m={},g=Object.keys(n),b=0;b<g.length;b++)l=g[b],0<=o.indexOf(l)||(m[l]=n[l]);return m}(r,d);if(Object.getOwnPropertySymbols)for(var e=Object.getOwnPropertySymbols(r),t=0;t<e.length;t++)i=e[t],0<=d.indexOf(i)||Object.prototype.propertyIsEnumerable.call(r,i)&&(h[i]=r[i]);return h}function j(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function k(r){var d=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var i,h,e,t,n=B(r);return h=d?(i=B(this).constructor,Reflect.construct(n,arguments,i)):n.apply(this,arguments),e=this,!(t=h)||typeof t!="object"&&typeof t!="function"?j(e):t}}function E(r,d){return function(i){if(Array.isArray(i))return i}(r)||function(i,h){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var e=[],t=!0,n=!1,o=void 0;try{for(var l,m=i[Symbol.iterator]();!(t=(l=m.next()).done)&&(e.push(l.value),!h||e.length!==h);t=!0);}catch(g){n=!0,o=g}finally{try{t||m.return==null||m.return()}finally{if(n)throw o}}return e}}(r,d)||F(r,d)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function F(r,d){if(r){if(typeof r=="string")return x(r,d);var i=Object.prototype.toString.call(r).slice(8,-1);return i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set"?Array.from(r):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?x(r,d):void 0}}function x(r,d){(d==null||d>r.length)&&(d=r.length);for(var i=0,h=new Array(d);i<d;i++)h[i]=r[i];return h}function y(r,d){return new Promise(function(i,h){var e,t=new Image;t.onload=function(){return i(t)},t.onerror=h,!((e=r)!==null&&e.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\-._~:@/?%\s]*\s*$/i))&&d&&(t.crossOrigin=d),t.src=r})}var U,T=!(typeof window>"u"||typeof navigator>"u"||!("ontouchstart"in window||0<navigator.msMaxTouchPoints)),z=typeof File<"u",ee={touch:{react:{down:"onTouchStart",mouseDown:"onMouseDown",drag:"onTouchMove",move:"onTouchMove",mouseMove:"onMouseMove",up:"onTouchEnd",mouseUp:"onMouseUp"},native:{down:"touchstart",mouseDown:"mousedown",drag:"touchmove",move:"touchmove",mouseMove:"mousemove",up:"touchend",mouseUp:"mouseup"}},desktop:{react:{down:"onMouseDown",drag:"onDragOver",move:"onMouseMove",up:"onMouseUp"},native:{down:"mousedown",drag:"dragStart",move:"mousemove",up:"mouseup"}}},V=T?ee.touch:ee.desktop,A=typeof window<"u"&&window.devicePixelRatio?window.devicePixelRatio:1,se={x:.5,y:.5},re=function(){(function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)})(h,I.default.Component);var r,d,i=k(h);function h(e){var t;return function(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}(this,h),w(j(t=i.call(this,e)),"state",{drag:!1,my:null,mx:null,image:se}),w(j(t),"handleImageReady",function(n){var o=t.getInitialSize(n.width,n.height);o.resource=n,o.x=.5,o.y=.5,o.backgroundColor=t.props.backgroundColor,t.setState({drag:!1,image:o},t.props.onImageReady),t.props.onLoadSuccess(o)}),w(j(t),"clearImage",function(){t.canvas.getContext("2d").clearRect(0,0,t.canvas.width,t.canvas.height),t.setState({image:se})}),w(j(t),"handleMouseDown",function(n){(n=n||window.event).preventDefault(),t.setState({drag:!0,mx:null,my:null})}),w(j(t),"handleMouseUp",function(){t.state.drag&&(t.setState({drag:!1}),t.props.onMouseUp())}),w(j(t),"handleMouseMove",function(n){var o,l,m,g,b,O,R,N,Z,_,q,$,H,ye,oe,G;n=n||window.event,t.state.drag!==!1&&(n.preventDefault(),m={mx:o=n.targetTouches?n.targetTouches[0].pageX:n.clientX,my:l=n.targetTouches?n.targetTouches[0].pageY:n.clientY},G=t.props.rotate,G=(G%=360)<0?G+360:G,t.state.mx&&t.state.my&&(g=t.state.mx-o,b=t.state.my-l,O=t.state.image.width*t.props.scale,R=t.state.image.height*t.props.scale,Z=(N=t.getCroppingRect()).x,_=N.y,Z*=O,_*=R,q=function(Ae){return Ae*(Math.PI/180)},$=Math.cos(q(G)),ye=_+-g*(H=Math.sin(q(G)))+b*$,oe={x:(Z+g*$+b*H)/O+1/t.props.scale*t.getXScale()/2,y:ye/R+1/t.props.scale*t.getYScale()/2},t.props.onPositionChange(oe),m.image=L(L({},t.state.image),oe)),t.setState(m),t.props.onMouseMove(n))}),w(j(t),"setCanvas",function(n){t.canvas=n}),t.canvas=null,t}return r=h,(d=[{key:"componentDidMount",value:function(){this.props.disableHiDPIScaling&&(A=1);var e,t,n=this.canvas.getContext("2d");this.props.image&&this.loadImage(this.props.image),this.paint(n),document&&(e=!!function(){var o=!1;try{var l=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("test",l,l),window.removeEventListener("test",l,l)}catch{o=!1}return o}()&&{passive:!1},t=V.native,document.addEventListener(t.move,this.handleMouseMove,e),document.addEventListener(t.up,this.handleMouseUp,e),T&&(document.addEventListener(t.mouseMove,this.handleMouseMove,e),document.addEventListener(t.mouseUp,this.handleMouseUp,e)))}},{key:"componentDidUpdate",value:function(e,t){this.props.image&&this.props.image!==e.image||this.props.width!==e.width||this.props.height!==e.height||this.props.backgroundColor!==e.backgroundColor?this.loadImage(this.props.image):this.props.image||t.image===se||this.clearImage();var n=this.canvas.getContext("2d");n.clearRect(0,0,this.canvas.width,this.canvas.height),this.paint(n),this.paintImage(n,this.state.image,this.props.border),e.image===this.props.image&&e.width===this.props.width&&e.height===this.props.height&&e.position===this.props.position&&e.scale===this.props.scale&&e.rotate===this.props.rotate&&t.my===this.state.my&&t.mx===this.state.mx&&t.image.x===this.state.image.x&&t.image.y===this.state.image.y&&t.backgroundColor===this.state.backgroundColor||this.props.onImageChange()}},{key:"componentWillUnmount",value:function(){var e;document&&(e=V.native,document.removeEventListener(e.move,this.handleMouseMove,!1),document.removeEventListener(e.up,this.handleMouseUp,!1),T&&(document.removeEventListener(e.mouseMove,this.handleMouseMove,!1),document.removeEventListener(e.mouseUp,this.handleMouseUp,!1)))}},{key:"isVertical",value:function(){return!this.props.disableCanvasRotation&&this.props.rotate%180!=0}},{key:"getBorders",value:function(e){var t=0<arguments.length&&e!==void 0?e:this.props.border;return Array.isArray(t)?t:[t,t]}},{key:"getDimensions",value:function(){var e=this.props,t=e.width,n=e.height,o=e.rotate,l=e.border,m={},g=E(this.getBorders(l),2),b=g[0],O=g[1],R=t,N=n;return this.isVertical()?(m.width=N,m.height=R):(m.width=R,m.height=N),m.width+=2*b,m.height+=2*O,{canvas:m,rotate:o,width:t,height:n,border:l}}},{key:"getImage",value:function(){var e=this.getCroppingRect(),t=this.state.image;e.x*=t.resource.width,e.y*=t.resource.height,e.width*=t.resource.width,e.height*=t.resource.height;var n=document.createElement("canvas");this.isVertical()?(n.width=e.height,n.height=e.width):(n.width=e.width,n.height=e.height);var o=n.getContext("2d");return o.translate(n.width/2,n.height/2),o.rotate(this.props.rotate*Math.PI/180),o.translate(-n.width/2,-n.height/2),this.isVertical()&&o.translate((n.width-n.height)/2,(n.height-n.width)/2),t.backgroundColor&&(o.fillStyle=t.backgroundColor,o.fillRect(-e.x,-e.y,t.resource.width,t.resource.height)),o.drawImage(t.resource,-e.x,-e.y),n}},{key:"getImageScaledToCanvas",value:function(){var e=this.getDimensions(),t=e.width,n=e.height,o=document.createElement("canvas");return this.isVertical()?(o.width=n,o.height=t):(o.width=t,o.height=n),this.paintImage(o.getContext("2d"),this.state.image,0,1),o}},{key:"getXScale",value:function(){var e=this.props.width/this.props.height,t=this.state.image.width/this.state.image.height;return Math.min(1,e/t)}},{key:"getYScale",value:function(){var e=this.props.height/this.props.width,t=this.state.image.height/this.state.image.width;return Math.min(1,e/t)}},{key:"getCroppingRect",value:function(){var e=this.props.position||{x:this.state.image.x,y:this.state.image.y},t=1/this.props.scale*this.getXScale(),n=1/this.props.scale*this.getYScale(),o={x:e.x-t/2,y:e.y-n/2,width:t,height:n},l=0,m=1-o.width,g=0,b=1-o.height;return(this.props.disableBoundaryChecks||1<t||1<n)&&(l=-o.width,g=-o.height,b=m=1),L(L({},o),{},{x:Math.max(l,Math.min(o.x,m)),y:Math.max(g,Math.min(o.y,b))})}},{key:"loadImage",value:function(e){var t;z&&e instanceof File?this.loadingImage=(t=e,new Promise(function(n,o){var l=new FileReader;l.onload=function(m){try{var g=y(m.target.result);n(g)}catch(b){o(b)}},l.readAsDataURL(t)}).then(this.handleImageReady).catch(this.props.onLoadFailure)):typeof e=="string"&&(this.loadingImage=y(e,this.props.crossOrigin).then(this.handleImageReady).catch(this.props.onLoadFailure))}},{key:"getInitialSize",value:function(e,t){var n,o,l=this.getDimensions();return t/e<l.height/l.width?o=e*((n=this.getDimensions().height)/t):n=t*((o=this.getDimensions().width)/e),{height:n,width:o}}},{key:"paintImage",value:function(e,t,n,o){var l,m=3<arguments.length&&o!==void 0?o:A;t.resource&&(l=this.calculatePosition(t,n),e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(this.props.rotate*Math.PI/180),e.translate(-e.canvas.width/2,-e.canvas.height/2),this.isVertical()&&e.translate((e.canvas.width-e.canvas.height)/2,(e.canvas.height-e.canvas.width)/2),e.scale(m,m),e.globalCompositeOperation="destination-over",e.drawImage(t.resource,l.x,l.y,l.width,l.height),t.backgroundColor&&(e.fillStyle=t.backgroundColor,e.fillRect(l.x,l.y,l.width,l.height)),e.restore())}},{key:"calculatePosition",value:function(e,t){e=e||this.state.image;var n=E(this.getBorders(t),2),o=n[0],l=n[1],m=this.getCroppingRect(),g=e.width*this.props.scale,b=e.height*this.props.scale,O=-m.x*g,R=-m.y*b;return this.isVertical()?(O+=l,R+=o):(O+=o,R+=l),{x:O,y:R,height:b,width:g}}},{key:"paint",value:function(e){e.save(),e.scale(A,A),e.translate(0,0),e.fillStyle="rgba("+this.props.color.slice(0,4).join(",")+")";var t,n,o,l,m,g,b,O,H=this.props.borderRadius,R=this.getDimensions(),N=E(this.getBorders(R.border),2),Z=N[0],_=N[1],q=R.canvas.height,$=R.canvas.width,H=Math.max(H,0);H=Math.min(H,$/2-Z,q/2-_),e.beginPath(),t=e,l=$-2*(n=Z),m=q-2*(o=_),(g=H)===0?t.rect(n,o,l,m):(b=l-g,O=m-g,t.translate(n,o),t.arc(g,g,g,Math.PI,1.5*Math.PI),t.lineTo(b,0),t.arc(b,g,g,1.5*Math.PI,2*Math.PI),t.lineTo(l,O),t.arc(b,O,g,2*Math.PI,.5*Math.PI),t.lineTo(g,m),t.arc(g,O,g,.5*Math.PI,Math.PI),t.translate(-n,-o)),e.rect($,0,-$,q),e.fill("evenodd"),e.restore()}},{key:"render",value:function(){var e=this.props,t=(e.scale,e.rotate,e.image,e.border,e.borderRadius,e.width,e.height,e.position,e.color,e.backgroundColor,e.style),n=(e.crossOrigin,e.onLoadFailure,e.onLoadSuccess,e.onImageReady,e.onImageChange,e.onMouseUp,e.onMouseMove,e.onPositionChange,e.disableBoundaryChecks,e.disableHiDPIScaling,e.disableCanvasRotation,W(e,["scale","rotate","image","border","borderRadius","width","height","position","color","backgroundColor","style","crossOrigin","onLoadFailure","onLoadSuccess","onImageReady","onImageChange","onMouseUp","onMouseMove","onPositionChange","disableBoundaryChecks","disableHiDPIScaling","disableCanvasRotation"])),o=this.getDimensions(),l={width:o.canvas.width,height:o.canvas.height,cursor:this.state.drag?"grabbing":"grab",touchAction:"none"},m={width:o.canvas.width*A,height:o.canvas.height*A,style:L(L({},l),t)};return m[V.react.down]=this.handleMouseDown,T&&(m[V.react.mouseDown]=this.handleMouseDown),I.default.createElement("canvas",S({ref:this.setCanvas},m,n))}}])&&M(r.prototype,d),h}();return w(re,"propTypes",{scale:s.default.number,rotate:s.default.number,image:s.default.oneOfType([s.default.string].concat(function(r){if(Array.isArray(r))return x(r)}(U=z?[s.default.instanceOf(File)]:[])||function(r){if(typeof Symbol<"u"&&Symbol.iterator in Object(r))return Array.from(r)}(U)||F(U)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())),border:s.default.oneOfType([s.default.number,s.default.arrayOf(s.default.number)]),borderRadius:s.default.number,width:s.default.number,height:s.default.number,position:s.default.shape({x:s.default.number,y:s.default.number}),color:s.default.arrayOf(s.default.number),backgroundColor:s.default.string,crossOrigin:s.default.oneOf(["","anonymous","use-credentials"]),onLoadFailure:s.default.func,onLoadSuccess:s.default.func,onImageReady:s.default.func,onImageChange:s.default.func,onMouseUp:s.default.func,onMouseMove:s.default.func,onPositionChange:s.default.func,disableBoundaryChecks:s.default.bool,disableHiDPIScaling:s.default.bool,disableCanvasRotation:s.default.bool}),w(re,"defaultProps",{scale:1,rotate:0,border:25,borderRadius:0,width:200,height:200,color:[0,0,0,.5],onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){},disableBoundaryChecks:!1,disableHiDPIScaling:!1,disableCanvasRotation:!0}),re})})(Be);var It=Be.exports;const Mt=Ue(It);function kt({name:u,src:f}){const v=K.useRef(),p=K.useRef(),[c,s]=K.useState(null),{isOpen:I,onOpen:M,onClose:w}=he(),S=async()=>{p.current};return a.jsxs(a.Fragment,{children:[a.jsx(be,{rounded:"md",cursor:"pointer",onClick:M,size:"2xl",src:f||void 0,name:u}),a.jsxs(me,{autoFocus:!1,isOpen:I,onClose:w,onCloseComplete:()=>s(null),closeOnOverlayClick:!1,children:[a.jsx(pe,{}),a.jsxs(ge,{children:[a.jsx(gt,{}),a.jsx(fe,{children:"Foto Profil Kamu"}),a.jsxs(ve,{py:"0",as:ue,children:[a.jsx(le,{boxSize:"250px",rounded:"xl",overflow:"hidden",outline:c?"3px solid":"",outlineColor:"yellow.400",children:c?a.jsx(Mt,{ref:p,image:URL.createObjectURL(c),width:250,height:250,border:0,color:[255,255,255,.6],rotate:0}):a.jsx(be,{rounded:"0",size:"2xl",mx:"auto",boxSize:"full",aspectRatio:1,src:f||void 0,name:u})}),a.jsxs(Q,{alignSelf:"start",children:[a.jsx(mt,{size:"18"}),a.jsx(ce,{children:c?"Paskan Foto dengan menggesernya":f?"Foto profil anda terlihat keren":"Anda Belum mengatur foto profil, Ayo atur sekarang"})]})]}),a.jsxs(xe,{as:Q,children:[!!f&&a.jsx(D,{leftIcon:a.jsx(pt,{size:"18"}),colorScheme:"red",children:"Hapus"}),a.jsx(Xe,{}),a.jsx(D,{colorScheme:"orange",leftIcon:a.jsx(De,{size:"18"}),onClick:()=>{v.current&&v.current.click()},children:"Ubah"}),!!c&&a.jsx(D,{type:"submit",colorScheme:"blue",onClick:S,children:"Simpan"}),a.jsx(de,{ref:v,type:"file",display:"none",accept:"image/*",id:"upload",onChange:P=>P.target.files?s(P.target.files[0]):null})]})]})]})]})}function ta(){const u=Ze(),{user:f,roleIs:v}=Oe(),p=u.pathname=="/account",c=p?f.userId:Pe().id,{data:s,mutate:I,error:M}=_e(`/users/${c}`,Je);if(M)throw M;return s?a.jsxs(le,{children:[a.jsx(qe,{Icon:a.jsx(et,{}),text:"Detail Akun"}),a.jsxs(ze,{mt:"5",maxW:"container.md",px:"0",children:[a.jsxs(Ve,{spacing:"6",align:"center",direction:{base:"column",sm:"row"},justify:"center",children:[a.jsx(kt,{name:s.name,src:s.profilePicture}),a.jsxs(le,{flex:"1 0 0",w:"full",children:[a.jsx(tt,{value:s.role}),a.jsx(Ne,{my:"1",fontSize:"2xl",children:s.name}),a.jsxs(Q,{children:[a.jsx(vt,{size:"16"}),a.jsx(Ce,{href:"mailto:"+s.email,children:s.email})]}),a.jsxs(Q,{children:[a.jsx($e,{size:"16"}),a.jsx(Ce,{href:"tel:"+s.phone,children:s.phone})]})]}),(p||v("admin"))&&a.jsx(Ct,{flexShrink:"0",colorScheme:"blue",alignSelf:"start",leftIcon:a.jsx(De,{size:"16"}),children:"Sunting Profil",data:s,mutate:I})]}),a.jsx(te,{IconEl:He,children:"Alamat"}),a.jsx(ce,{children:s.address}),a.jsx(te,{IconEl:Ke,children:"Deskripsi pengguna"}),a.jsx(ce,{fontStyle:s.description?"normal":"italic",color:s.description?"inherit":"gray.500",children:s.description||"Tidak Ada Deskripsi pengguna"}),!p&&a.jsxs(a.Fragment,{children:[s.role=="manager"&&a.jsxs(a.Fragment,{children:[a.jsxs(te,{IconEl:Ie,children:["Perusahaan Anda",a.jsx(we,{colorScheme:"blue",ml:"2",children:s.countManagedCompany||0})]}),v("admin")&&a.jsx(at,{to:"/companies/create",children:a.jsx(D,{colorScheme:"blue",leftIcon:a.jsx(Me,{size:"18"}),children:"Tambahkan Perusahaan"})}),a.jsx(st,{mt:"4",data:s,mutate:I})]}),s.role=="regular"&&a.jsxs(a.Fragment,{children:[a.jsxs(te,{IconEl:Ie,children:["Node yang Ikuti",a.jsx(we,{colorScheme:"blue",ml:"2",children:s.countSubscribedNodes||0})]}),v("admin")&&a.jsx(Q,{children:a.jsx(D,{colorScheme:"blue",leftIcon:a.jsx(Me,{size:"18"}),children:"Tambahkan Node"})}),a.jsx(rt,{mt:"4",data:s,mutate:I})]})]}),(p||v("admin"))&&a.jsxs(a.Fragment,{children:[a.jsx(te,{IconEl:nt,children:"Autentikasi"}),a.jsxs(Q,{justify:"space-between",children:[p&&a.jsx(jt,{colorScheme:"yellow",data:s,children:"Ganti Kata Sandi"}),a.jsx(We,{resource:"Pengguna",name:s.name,colorScheme:"red",deleteApiUrl:"/users/"+s.userId,redirectPath:"/users"})]})]})]})]}):a.jsx(Qe,{})}export{ta as default};
