import{j as e,T as h}from"./createReactComponent-BjMSnX4u.js";import{u as C,b as y,f as I,L,y as j,q as V,H,v as f,Q as G,T as P,J as b,C as M,K as W}from"./app-Dlg_0vKY.js";import{M as B}from"./index-CmYfqyqM.js";import{b as z}from"./index.tags-CTXl78sl.js";import{G as A}from"./GMapsButton-C93BsDGw.js";import{H as U}from"./HeadingWithIcon-DhQ1h7S6.js";import{u as F,S as g}from"./useHashBasedTabsIndex-DNE1V7nT.js";import{a as K}from"./dateFormating-BW4zoMdD.js";import{I as E}from"./IconPlus-Cgy6QNmz.js";import{I as O}from"./IconExternalLink-BqvmzRBb.js";import{F as p}from"./chunk-KRPLQIP4-CDbFQY1-.js";import{H as T}from"./icon-CgCgY_AD.js";import{B as N,c as R}from"./axios-DSJo49NX.js";import{G as q}from"./chunk-JARCRF6W-Cx94atoP.js";import{T as J,a as Q,b as x}from"./chunk-4YMKQ5D4-CSotNFLB.js";import{T as _,a as X}from"./chunk-IAXSQ4X2-Ev1MD7D1.js";import"./TagWithIcon-BjtYG5-s.js";import"./chunk-K7XRJ7NL-k64nE7jn.js";const r=W(),u=[r.accessor("name",{header:"Nama",cell:a=>a.getValue()}),r.accessor("isUptodate",{header:"Status",cell:a=>e.jsx(z,{value:a.getValue()})}),r.accessor("address",{header:"Alamat",cell:a=>e.jsx(h,{noOfLines:2,whiteSpace:"wrap",children:a.getValue()})}),r.accessor("coordinate",{header:"Koordinat",cell:a=>e.jsx(A,{coordinate:a.getValue()})}),r.accessor("lastDataSent",{header:"Terakhir data dikirim",cell:a=>K(a.getValue())||"-"}),r.accessor("nodeId",{header:"Aksi",cell:a=>e.jsx(f,{to:"/nodes/"+a.getValue(),children:e.jsx(N,{colorScheme:"blue",size:"sm",leftIcon:e.jsx(O,{size:"16"}),children:"Detail"})})})],Y=[...u.slice(0,2),r.accessor("owner",{header:"Perusahaan",cell:a=>e.jsx(f,{to:"/companies/"+a.getValue().companyId,children:e.jsxs(T,{children:[e.jsx(M,{type:a.getValue().type}),e.jsx(h,{children:a.getValue().name})]})})}),...u.slice(4)],w=[{label:"Daftar Node Publik",key:"public"},{label:"Daftar Node Privat",key:"private"},{label:"Lihat Dalam Maps",key:"map"}];function je(){const{roleIs:a}=C(),l=a("manager")?[w[1]]:w,[s,d]=F(l.map(o=>o.key)),{data:t}=y("/nodes/overview",I);if(!t)return e.jsx(L,{});const i=[{label:"Status Node",data:t.status,flex:"1 0 30px"}];return a("manager")||i.unshift({label:"Kepemilikan Node",data:t.ownership,flex:"1 0 30px"}),e.jsxs(p,{gap:"2",flexDir:"column",children:[e.jsxs(T,{w:"full",spacing:"4",align:"start",children:[e.jsx(U,{Icon:e.jsx(j,{}),text:"Daftar Node"}),e.jsx(V,{}),e.jsx(H,{w:"200px",bg:"white",placeholder:"Cari ..",_onSubmit:null}),a(["admin","manager"])&&e.jsx(f,{to:"./create",children:e.jsx(N,{leftIcon:e.jsx(E,{size:"20px"}),colorScheme:"green",children:"Tambah Node"})})]}),e.jsxs(p,{gap:"3",direction:["column","row"],justify:"space-between",flexWrap:"wrap",children:[e.jsx(g,{flex:"0 0 180px",icon:j,count:t.all,label:"Total Node",h:"full",variant:"solid",bg:"blue.400"}),e.jsx(p,{flex:"1 1 0",gap:"3",children:i.map(({label:o,data:m,flex:n})=>e.jsxs(R,{flex:n,maxW:"600px",pb:"2",rounded:"md",px:"3",border:"1px solid",borderColor:"gray.300",children:[e.jsx(h,{fontWeight:"600",py:"1",children:o}),e.jsx(q,{gap:"3",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",children:m.map((c,S)=>{const{color:k,name:D,icon:v}={...G,...P}[c.value];return e.jsx(g,{flex:"1 0 180px",icon:v,color:k,count:c.count,label:D},S)})})]},o))})]}),e.jsxs(J,{display:"flex",flexDir:"column",flexGrow:"1",index:s,onChange:d,isLazy:!0,children:[e.jsx(_,{children:l.map(o=>e.jsx(X,{children:o.label},o.key))}),e.jsxs(Q,{flexGrow:"1",children:[e.jsx(x,{px:"0",children:e.jsx(b,{flexGrow:"1",apiUrl:"/nodes?ownship=public",columns:u})}),e.jsx(x,{px:"0",children:e.jsx(b,{flexGrow:"1",apiUrl:"/nodes?ownship=private",columns:Y})}),e.jsx(x,{px:"0",h:"100%",children:e.jsx(Z,{})})]})]})]})}function Z(){const{data:a}=y("/nodes?all=true",I);if(!a)return"loading slurr";const l=Object.values(a.rows.filter(s=>s.companyId&&s.owner).reduce((s,d)=>{const{coordinate:t,owner:i,...o}=d,{name:m,companyId:n,type:c}=i;return s[n]||(s[n]={name:m,companyId:n,type:c,coordinate:t,indoorNodes:[]}),s[n].indoorNodes.push(o),s},{}));return e.jsx(B,{h:"100%",minH:"350px",companiesData:l,data:a.rows.filter(s=>!s.companyId)})}export{Y as columPrivateNodeTable,je as default};
