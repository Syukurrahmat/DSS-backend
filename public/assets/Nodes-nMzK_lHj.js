import{j as e,M as y,N as C,T as h}from"./createReactComponent-CTa0ICdI.js";import{u as V,V as L,b as I,f as T,L as G,y as j,q as H,H as M,v as f,Q as P,T as W,J as b,C as B,K as z}from"./app-B_Z13nOW.js";import{M as A}from"./index-BA-WadA8.js";import{b as U}from"./index.tags-BMl43ewZ.js";import{G as F}from"./GMapsButton-D7P2Eayx.js";import{H as K}from"./HeadingWithIcon-D2dFdTXW.js";import{S as g}from"./StatWithIcon-CqUgXY0l.js";import{a as E}from"./dateFormating-b7MTPZXO.js";import{I as O}from"./IconPlus-Rmn2fZV2.js";import{I as R}from"./IconExternalLink-C9IKUlwJ.js";import{F as m}from"./chunk-KRPLQIP4-noB-ZVK0.js";import{B as N}from"./icon-white-DmkG9gB2.js";import{G as q}from"./chunk-JARCRF6W-CMtdO6Jo.js";import{T as J,a as Q,b as x}from"./chunk-4YMKQ5D4-DYkDvR0m.js";import{T as _,a as X}from"./chunk-IAXSQ4X2-DpX_T3X7.js";import"./icon-BHz-Vl6Z.js";import"./TagWithIcon-xFUgUEwJ.js";import"./chunk-K7XRJ7NL-DQvnGBvV.js";const r=z(),u=[r.accessor("name",{header:"Nama",cell:a=>a.getValue()}),r.accessor("isUptodate",{header:"Status",cell:a=>e.jsx(U,{value:a.getValue()})}),r.accessor("address",{header:"Alamat",cell:a=>e.jsx(h,{noOfLines:2,whiteSpace:"wrap",children:a.getValue()})}),r.accessor("coordinate",{header:"Koordinat",cell:a=>e.jsx(F,{coordinate:a.getValue()})}),r.accessor("lastDataSent",{header:"Terakhir data dikirim",cell:a=>E(a.getValue())||"-"}),r.accessor("nodeId",{header:"Aksi",cell:a=>e.jsx(f,{to:"/nodes/"+a.getValue(),children:e.jsx(N,{colorScheme:"blue",size:"sm",leftIcon:e.jsx(R,{size:"16"}),children:"Detail"})})})],Y=[...u.slice(0,2),r.accessor("owner",{header:"Perusahaan",cell:a=>e.jsx(f,{to:"/companies/"+a.getValue().companyId,children:e.jsxs(y,{children:[e.jsx(B,{type:a.getValue().type}),e.jsx(h,{children:a.getValue().name})]})})}),...u.slice(4)],w=[{label:"Daftar Node Publik",key:"public"},{label:"Daftar Node Privat",key:"private"},{label:"Lihat Dalam Maps",key:"map"}];function je(){const{roleIs:a}=V(),l=a("manager")?[w[1]]:w,[s,d]=L(l.map(o=>o.key)),{data:t}=I("/nodes/overview",T);if(!t)return e.jsx(G,{});const i=[{label:"Status Node",data:t.status,flex:"1 0 30px"}];return a("manager")||i.unshift({label:"Kepemilikan Node",data:t.ownership,flex:"1 0 30px"}),e.jsxs(m,{gap:"2",flexDir:"column",children:[e.jsxs(y,{w:"full",spacing:"4",align:"start",children:[e.jsx(K,{Icon:e.jsx(j,{}),text:"Daftar Node"}),e.jsx(H,{}),e.jsx(M,{w:"200px",bg:"white",placeholder:"Cari ..",_onSubmit:null}),a(["admin","manager"])&&e.jsx(f,{to:"./create",children:e.jsx(N,{leftIcon:e.jsx(O,{size:"20px"}),colorScheme:"green",children:"Tambah Node"})})]}),e.jsxs(m,{gap:"3",direction:["column","row"],justify:"space-between",flexWrap:"wrap",children:[e.jsx(g,{flex:"0 0 180px",icon:j,count:t.all,label:"Total Node",h:"full",variant:"solid",bg:"blue.400"}),e.jsx(m,{flex:"1 1 0",gap:"3",children:i.map(({label:o,data:p,flex:n})=>e.jsxs(C,{flex:n,maxW:"600px",pb:"2",rounded:"md",px:"3",border:"1px solid",borderColor:"gray.300",children:[e.jsx(h,{fontWeight:"600",py:"1",children:o}),e.jsx(q,{gap:"3",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",children:p.map((c,S)=>{const{color:k,name:D,icon:v}={...P,...W}[c.value];return e.jsx(g,{flex:"1 0 180px",icon:v,color:k,count:c.count,label:D},S)})})]},o))})]}),e.jsxs(J,{display:"flex",flexDir:"column",flexGrow:"1",index:s,onChange:d,isLazy:!0,children:[e.jsx(_,{children:l.map(o=>e.jsx(X,{children:o.label},o.key))}),e.jsxs(Q,{flexGrow:"1",children:[e.jsx(x,{px:"0",children:e.jsx(b,{flexGrow:"1",apiUrl:"/nodes?ownship=public",columns:u})}),e.jsx(x,{px:"0",children:e.jsx(b,{flexGrow:"1",apiUrl:"/nodes?ownship=private",columns:Y})}),e.jsx(x,{px:"0",h:"100%",children:e.jsx(Z,{})})]})]})]})}function Z(){const{data:a}=I("/nodes?all=true",T);if(!a)return"loading slurr";const l=Object.values(a.rows.filter(s=>s.companyId&&s.owner).reduce((s,d)=>{const{coordinate:t,owner:i,...o}=d,{name:p,companyId:n,type:c}=i;return s[n]||(s[n]={name:p,companyId:n,type:c,coordinate:t,indoorNodes:[]}),s[n].indoorNodes.push(o),s},{}));return e.jsx(A,{h:"100%",minH:"350px",companiesData:l,data:a.rows.filter(s=>!s.companyId)})}export{Y as columPrivateNodeTable,je as default};
