import{H as ue,r as K,R as Q,j as a,V as he,C as Ue,i as ze,T as le,F as Ve,J as He}from"./createReactComponent-BjMSnX4u.js";import{H as Ne}from"./HeadingWithIcon-DhQ1h7S6.js";import{S as te}from"./SectionTitle-CbtCqmUO.js";import{d as me,m as Pe,M as pe,g as ge,h as fe,i as ve,j as xe,k as ye,o as Se,u as Oe,p as $e,r as Ke,A as we,q as Re,s as We,b as qe,f as Ge,L as Xe,t as Ye,v as _e,w as Je}from"./app-Dlg_0vKY.js";import{T as Ze}from"./index.tags-CTXl78sl.js";import{M as Qe}from"./DTManagedCompanies-CCD-FYWs.js";import{U as et}from"./DTUserSubscribedNodes-B8ymOCnn.js";import{I as ie}from"./inputPassword-CGG6LjW9.js";import{u as Le,a as Ee,c as tt}from"./common.utils-T8z9TsUm.js";import{p as at,n as nt,a as st,b as ot,d as rt}from"./validator.utils-CBwZjXbt.js";import{u as Te,c as De,F as Y,b as ae}from"./index.esm-C4YBZUZR.js";import{B as D,F as _,e as ce,c as de,b as it,A as lt}from"./axios-DSJo49NX.js";import{T as je}from"./chunk-4IH3O7BJ-s8F57N1M.js";import{I as ct}from"./IconInfoCircle-qPZJRoQg.js";import{I as dt}from"./IconTrash-DOqppO8G.js";import{I as Be}from"./IconEdit-Chltx2AE.js";import{M as ut}from"./chunk-4FCEGNGT-Dke9LU8Y.js";import{H as X}from"./icon-CgCgY_AD.js";import{I as ht,a as mt,b as pt,D as gt}from"./DeleteReourceButton-HzfbpiX8.js";import{L as Ce}from"./chunk-K7XRJ7NL-k64nE7jn.js";import{I as Ie}from"./IconUsersGroup-DyLjGcvO.js";import{I as Me}from"./IconCirclePlus-XtyQ80kD.js";import{T as ke}from"./dateFormating-BW4zoMdD.js";import"./index-CmYfqyqM.js";import"./TagWithIcon-BjtYG5-s.js";import"./IconExternalLink-BqvmzRBb.js";import"./commonColumn-BPdH03Da.js";import"./chunk-4YMKQ5D4-CSotNFLB.js";/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ft=ue("outline","circle-check","IconCircleCheck",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var vt=ue("outline","exclamation-circle","IconExclamationCircle",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M12 9v4",key:"svg-1"}],["path",{d:"M12 16v.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var xt=ue("outline","mail","IconMail",[["path",{d:"M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z",key:"svg-0"}],["path",{d:"M3 7l9 6l9 -6",key:"svg-1"}]]),ne=function(){return ne=Object.assign||function(u){for(var f,v=1,p=arguments.length;v<p;v++){f=arguments[v];for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&(u[c]=f[c])}return u},ne.apply(this,arguments)},yt=function(u,f){var v={};for(var p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.indexOf(p)<0&&(v[p]=u[p]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,p=Object.getOwnPropertySymbols(u);c<p.length;c++)f.indexOf(p[c])<0&&Object.prototype.propertyIsEnumerable.call(u,p[c])&&(v[p[c]]=u[p[c]]);return v},bt=function(u){var f=u.className,v=u.style,p=u.rules,c=u.value,s=u.valueAgain,I=u.minLength,M=u.maxLength,w=u.rtl,S=u.onChange,k=u.specialCharsRegex,L=k===void 0?/[~`¿¡!#$%\^&*€£@+÷=\-\[\]\\';,/{}\(\)|\\":<>\?\.\_]/g:k,B=u.messages,C=B===void 0?{}:B,W=yt(u,["className","style","rules","value","valueAgain","minLength","maxLength","rtl","onChange","specialCharsRegex","messages"]),j={minLength:{valid:c.length>=(I||100),message:C.minLength||"Password has at least ".concat(I," characters.")},specialChar:{valid:L.test(c),message:C.specialChar||"Password has special characters."},number:{valid:/\d/g.test(c),message:C.number||"Password has a number."},capital:{valid:function(){var x=0;if(c.length===0)return!1;for(;x<c.length;){var y=c.charAt(x);if(y!=y.toLowerCase()){if(y==y.toUpperCase())return!0}x++}return!1}(),message:C.capital||"Password has a capital letter."},match:{valid:c.length>0&&c===s,message:C.match||"Passwords match."},lowercase:{valid:function(){var x=0;if(c.length===0)return!1;for(;x<c.length;){var y=c.charAt(x);if(y!=y.toUpperCase()){if(y==y.toLowerCase())return!0}x++}return!1}(),message:C.lowercase||"Password has a lowercase letter."},letter:{valid:/[a-zA-Z]/g.test(c),message:C.letter||"Password has a letter."},maxLength:{valid:c.length<=(M||16),message:C.maxLength||"Password has no more than ".concat(M," characters.")},notEmpty:{valid:!!(c.length>0&&s&&s.length>0),message:C.notEmpty||"Password fields are not empty."}},P=K.useMemo(function(){return p.filter(function(x){return!!j[x]})},[p]),E=P.every(function(x){return j[x].valid}),F=K.useMemo(function(){return P.filter(function(x){return!j[x].valid})},[c,s,P]);return K.useEffect(function(){typeof S=="function"&&S(E,F)},[E,F]),w&&(f=f?f+" rtl":"rtl"),Q.createElement("ul",{className:f,style:ne({margin:0,padding:0},v)},P.map(function(x){var y=j[x],U=y.message,T=y.valid;return Q.createElement(wt,ne({key:x,valid:T,iconSize:18,validColor:"#4BCA81",invalidColor:"#FF0033",rtl:w},W),U)}))},wt=function(u){var f=u.valid,v=u.iconSize,p=u.validColor,c=u.invalidColor,s=u.validTextColor,I=u.invalidTextColor,M=u.iconComponents,w=u.hideIcon,S=u.rtl,k=u.children;return Q.createElement("li",{className:f?"valid":"invalid",style:{listStyleType:"none",display:"flex",alignItems:"flex-start",margin:"2px 0"}},w?null:M?f?M.ValidIcon:M.InvalidIcon:Q.createElement("svg",{className:"checklist-icon",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:v,height:v,viewBox:"0 0 512 512",style:{marginRight:S?0:5,marginLeft:S?5:0}},Q.createElement("path",{fill:f?p:c,d:f?"M432 64l-240 240-112-112-80 80 192 192 320-320z":"M507.331 411.33c-0.002-0.002-0.004-0.004-0.006-0.005l-155.322-155.325 155.322-155.325c0.002-0.002 0.004-0.003 0.006-0.005 1.672-1.673 2.881-3.627 3.656-5.708 2.123-5.688 0.912-12.341-3.662-16.915l-73.373-73.373c-4.574-4.573-11.225-5.783-16.914-3.66-2.080 0.775-4.035 1.984-5.709 3.655 0 0.002-0.002 0.003-0.004 0.005l-155.324 155.326-155.324-155.325c-0.002-0.002-0.003-0.003-0.005-0.005-1.673-1.671-3.627-2.88-5.707-3.655-5.69-2.124-12.341-0.913-16.915 3.66l-73.374 73.374c-4.574 4.574-5.784 11.226-3.661 16.914 0.776 2.080 1.985 4.036 3.656 5.708 0.002 0.001 0.003 0.003 0.005 0.005l155.325 155.324-155.325 155.326c-0.001 0.002-0.003 0.003-0.004 0.005-1.671 1.673-2.88 3.627-3.657 5.707-2.124 5.688-0.913 12.341 3.661 16.915l73.374 73.373c4.575 4.574 11.226 5.784 16.915 3.661 2.080-0.776 4.035-1.985 5.708-3.656 0.001-0.002 0.003-0.003 0.005-0.005l155.324-155.325 155.324 155.325c0.002 0.001 0.004 0.003 0.006 0.004 1.674 1.672 3.627 2.881 5.707 3.657 5.689 2.123 12.342 0.913 16.914-3.661l73.373-73.374c4.574-4.574 5.785-11.227 3.662-16.915-0.776-2.080-1.985-4.034-3.657-5.707z"})),Q.createElement("span",{style:{paddingTop:2,opacity:f?1:I?void 0:.5,flex:1,color:f?s:I}},k))};const jt=bt;function Ct({data:u,...f}){const{isOpen:v,onOpen:p,onClose:c}=me(),s=Le(),[I,M]=K.useState(!1),{userId:w}=u,{handleChange:S,handleBlur:k,values:L,touched:B,errors:C,isSubmitting:W,setSubmitting:j,setFieldError:P,handleSubmit:E,resetForm:F}=Te({initialValues:{password:"",confirmPassword:"",newPassword:""},validationSchema:De().shape({password:at.required("Wajib diisi")}),onSubmit:x=>{if(!I){j(!1),s.opss("Masukan kata sandi baru sesuai intruksi");return}const{password:y,newPassword:U}=Ee(x);Pe.patch(`/users/${w}/`,{password:y,newPassword:U}).then(()=>{s.success("Berhasil Memperharui kata sandi"),c()}).catch(T=>{var z;((z=T.response)==null?void 0:z.status)===401?P("password","Kata sandi salah"):(s.error("Gagal Memperharui kata sandi"),c())}).finally(()=>{j(!1)})}});return a.jsxs(a.Fragment,{children:[a.jsx(D,{onClick:p,...f}),a.jsxs(pe,{size:"lg",autoFocus:!1,isOpen:v,onClose:c,onCloseComplete:F,closeOnOverlayClick:!1,children:[a.jsx(ge,{}),a.jsx(fe,{children:a.jsxs("form",{onSubmit:E,className:"my-form",children:[a.jsx(ve,{children:"Perbarui Kata Sandi"}),a.jsx(xe,{children:a.jsxs(he,{mx:"auto",spacing:"2",maxW:"container.sm",children:[a.jsxs(_,{isInvalid:!!C.password&&B.password,children:[a.jsx(Y,{children:"Kata sandi"}),a.jsx(ie,{id:"password",name:"password",autoComplete:"password",placeholder:"Masukkan kata sandi saat ini",onChange:S,onBlur:k}),a.jsx(ae,{children:C.password})]}),a.jsxs(_,{children:[a.jsx(Y,{children:"Kata sandi Baru"}),a.jsx(ie,{id:"newPassword",name:"newPassword",placeholder:"Masukkan kata sandi",onChange:S})]}),a.jsxs(_,{children:[a.jsx(Y,{children:"Konfirmasi Kata Sandi"}),a.jsx(ie,{id:"confirmPassword",name:"confirmPassword",autoComplete:"new-password",placeholder:"Tulis ulang kata sandi anda",onChange:S})]}),a.jsx(jt,{style:{width:"100%",marginTop:"0.5em"},rules:["minLength","number","capital","match"],minLength:8,value:L.newPassword,valueAgain:L.confirmPassword,onChange:M,messages:{minLength:"Kata sandi harus lebih dari 8 karakter",number:"Kata sandi harus mengandung angka",capital:"Kata sandi harus mengandung huruf kapital",match:"Tulis ulang kata sandi"},iconComponents:{ValidIcon:a.jsx(ft,{color:"green",size:"20",style:{margin:"3px 5px 0 0"}}),InvalidIcon:a.jsx(vt,{color:"red",size:"20",style:{margin:"3px 5px 0 0"}})}})]})}),a.jsxs(ye,{children:[a.jsx(D,{variant:"ghost",onClick:c,children:"Batal"}),a.jsx(D,{isLoading:W,type:"submit",colorScheme:"blue",ml:3,children:"Submit"})]})]})})]})]})}function It({data:u,mutate:f,...v}){const{name:p,phone:c,description:s,address:I}=u,M={name:p,phone:c,description:s,address:I},{isOpen:w,onOpen:S,onClose:k}=me(),{id:L}=Se(),{user:B}=Oe(),C=Le(),W=$e("/account")?B.userId:L,{values:j,errors:P,touched:E,isSubmitting:F,handleSubmit:x,handleBlur:y,resetForm:U,handleChange:T,setSubmitting:z}=Te({initialValues:M,validationSchema:De().shape({name:nt.required("Wajib diisi"),phone:st.required("Wajib diisi"),address:ot.required("Wajib diisi"),description:rt.nullable()}),onSubmit:ee=>{Ee(ee);const V=tt(M,ee);if(Object.keys(V).length===0){C.opss("Belum ada yang disunting"),z(!1);return}Pe.patch(`/users/${W}/`,{...V}).then(()=>{C.success("Berhasil Memperharui data"),f(A=>A&&{...A,...V})}).catch(()=>{C.error("Gagal Memperharui data")}).finally(()=>{z(!1),k()})}});return a.jsxs(a.Fragment,{children:[a.jsx(D,{onClick:S,...v}),a.jsxs(pe,{size:"lg",autoFocus:!1,isOpen:w,onClose:k,closeOnOverlayClick:!1,children:[a.jsx(ge,{}),a.jsx(fe,{children:a.jsxs("form",{onSubmit:x,className:"my-form",children:[a.jsx(ve,{children:"Sunting Profil"}),a.jsx(xe,{children:a.jsxs(he,{mx:"auto",spacing:"2",maxW:"container.sm",children:[a.jsxs(_,{isInvalid:!!P.name&&E.name,children:[a.jsx(Y,{children:"Nama"}),a.jsx(ce,{id:"name",name:"name",placeholder:"Misal : Suparna",onChange:T,onBlur:y,value:j.name}),a.jsx(ae,{children:P.name})]}),a.jsxs(_,{isInvalid:!!P.phone&&E.phone,children:[a.jsx(Y,{children:"Nomor Telepon"}),a.jsx(ce,{id:"phone",name:"phone",placeholder:"Misal : 087812345678",onChange:T,onBlur:y,value:j.phone}),a.jsx(ae,{children:P.phone})]}),a.jsxs(_,{isInvalid:!!P.address&&E.address,children:[a.jsx(Y,{children:"Alamat"}),a.jsx(je,{id:"address",name:"address",placeholder:"Masukkan Alamat Tempat tinggal Pengguna",onChange:T,onBlur:y,value:j.address}),a.jsx(ae,{children:P.address})]}),a.jsxs(_,{isInvalid:!!P.description&&E.description,children:[a.jsx(Y,{children:"Description"}),a.jsx(je,{id:"description",name:"description",placeholder:"Opsional",onChange:T,onBlur:y,value:j.description}),a.jsx(ae,{children:P.description})]})]})}),a.jsxs(ye,{children:[a.jsx(D,{variant:"ghost",onClick:()=>{U(),k()},children:"Batal"}),a.jsx(D,{isLoading:F,type:"submit",colorScheme:"blue",ml:3,children:"Submit"})]})]})})]})]})}var Ae={exports:{}};(function(u,f){(function(v,p){u.exports=p(Ke(),K)})(Ue,function(v,p){function c(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var s=c(v),I=c(p);function M(o,d){for(var i=0;i<d.length;i++){var h=d[i];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(o,h.key,h)}}function w(o,d,i){return d in o?Object.defineProperty(o,d,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[d]=i,o}function S(){return(S=Object.assign||function(o){for(var d=1;d<arguments.length;d++){var i=arguments[d];for(var h in i)Object.prototype.hasOwnProperty.call(i,h)&&(o[h]=i[h])}return o}).apply(this,arguments)}function k(o,d){var i,h=Object.keys(o);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(o),d&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})),h.push.apply(h,i)),h}function L(o){for(var d=1;d<arguments.length;d++){var i=arguments[d]!=null?arguments[d]:{};d%2?k(Object(i),!0).forEach(function(h){w(o,h,i[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):k(Object(i)).forEach(function(h){Object.defineProperty(o,h,Object.getOwnPropertyDescriptor(i,h))})}return o}function B(o){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)})(o)}function C(o,d){return(C=Object.setPrototypeOf||function(i,h){return i.__proto__=h,i})(o,d)}function W(o,d){if(o==null)return{};var i,h=function(n,r){if(n==null)return{};for(var l,m={},g=Object.keys(n),b=0;b<g.length;b++)l=g[b],0<=r.indexOf(l)||(m[l]=n[l]);return m}(o,d);if(Object.getOwnPropertySymbols)for(var e=Object.getOwnPropertySymbols(o),t=0;t<e.length;t++)i=e[t],0<=d.indexOf(i)||Object.prototype.propertyIsEnumerable.call(o,i)&&(h[i]=o[i]);return h}function j(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function P(o){var d=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var i,h,e,t,n=B(o);return h=d?(i=B(this).constructor,Reflect.construct(n,arguments,i)):n.apply(this,arguments),e=this,!(t=h)||typeof t!="object"&&typeof t!="function"?j(e):t}}function E(o,d){return function(i){if(Array.isArray(i))return i}(o)||function(i,h){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(i)))){var e=[],t=!0,n=!1,r=void 0;try{for(var l,m=i[Symbol.iterator]();!(t=(l=m.next()).done)&&(e.push(l.value),!h||e.length!==h);t=!0);}catch(g){n=!0,r=g}finally{try{t||m.return==null||m.return()}finally{if(n)throw r}}return e}}(o,d)||F(o,d)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function F(o,d){if(o){if(typeof o=="string")return x(o,d);var i=Object.prototype.toString.call(o).slice(8,-1);return i==="Object"&&o.constructor&&(i=o.constructor.name),i==="Map"||i==="Set"?Array.from(o):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?x(o,d):void 0}}function x(o,d){(d==null||d>o.length)&&(d=o.length);for(var i=0,h=new Array(d);i<d;i++)h[i]=o[i];return h}function y(o,d){return new Promise(function(i,h){var e,t=new Image;t.onload=function(){return i(t)},t.onerror=h,!((e=o)!==null&&e.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\-._~:@/?%\s]*\s*$/i))&&d&&(t.crossOrigin=d),t.src=o})}var U,T=!(typeof window>"u"||typeof navigator>"u"||!("ontouchstart"in window||0<navigator.msMaxTouchPoints)),z=typeof File<"u",ee={touch:{react:{down:"onTouchStart",mouseDown:"onMouseDown",drag:"onTouchMove",move:"onTouchMove",mouseMove:"onMouseMove",up:"onTouchEnd",mouseUp:"onMouseUp"},native:{down:"touchstart",mouseDown:"mousedown",drag:"touchmove",move:"touchmove",mouseMove:"mousemove",up:"touchend",mouseUp:"mouseup"}},desktop:{react:{down:"onMouseDown",drag:"onDragOver",move:"onMouseMove",up:"onMouseUp"},native:{down:"mousedown",drag:"dragStart",move:"mousemove",up:"mouseup"}}},V=T?ee.touch:ee.desktop,A=typeof window<"u"&&window.devicePixelRatio?window.devicePixelRatio:1,se={x:.5,y:.5},oe=function(){(function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)})(h,I.default.Component);var o,d,i=P(h);function h(e){var t;return function(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}(this,h),w(j(t=i.call(this,e)),"state",{drag:!1,my:null,mx:null,image:se}),w(j(t),"handleImageReady",function(n){var r=t.getInitialSize(n.width,n.height);r.resource=n,r.x=.5,r.y=.5,r.backgroundColor=t.props.backgroundColor,t.setState({drag:!1,image:r},t.props.onImageReady),t.props.onLoadSuccess(r)}),w(j(t),"clearImage",function(){t.canvas.getContext("2d").clearRect(0,0,t.canvas.width,t.canvas.height),t.setState({image:se})}),w(j(t),"handleMouseDown",function(n){(n=n||window.event).preventDefault(),t.setState({drag:!0,mx:null,my:null})}),w(j(t),"handleMouseUp",function(){t.state.drag&&(t.setState({drag:!1}),t.props.onMouseUp())}),w(j(t),"handleMouseMove",function(n){var r,l,m,g,b,O,R,H,J,Z,q,N,$,be,re,G;n=n||window.event,t.state.drag!==!1&&(n.preventDefault(),m={mx:r=n.targetTouches?n.targetTouches[0].pageX:n.clientX,my:l=n.targetTouches?n.targetTouches[0].pageY:n.clientY},G=t.props.rotate,G=(G%=360)<0?G+360:G,t.state.mx&&t.state.my&&(g=t.state.mx-r,b=t.state.my-l,O=t.state.image.width*t.props.scale,R=t.state.image.height*t.props.scale,J=(H=t.getCroppingRect()).x,Z=H.y,J*=O,Z*=R,q=function(Fe){return Fe*(Math.PI/180)},N=Math.cos(q(G)),be=Z+-g*($=Math.sin(q(G)))+b*N,re={x:(J+g*N+b*$)/O+1/t.props.scale*t.getXScale()/2,y:be/R+1/t.props.scale*t.getYScale()/2},t.props.onPositionChange(re),m.image=L(L({},t.state.image),re)),t.setState(m),t.props.onMouseMove(n))}),w(j(t),"setCanvas",function(n){t.canvas=n}),t.canvas=null,t}return o=h,(d=[{key:"componentDidMount",value:function(){this.props.disableHiDPIScaling&&(A=1);var e,t,n=this.canvas.getContext("2d");this.props.image&&this.loadImage(this.props.image),this.paint(n),document&&(e=!!function(){var r=!1;try{var l=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("test",l,l),window.removeEventListener("test",l,l)}catch{r=!1}return r}()&&{passive:!1},t=V.native,document.addEventListener(t.move,this.handleMouseMove,e),document.addEventListener(t.up,this.handleMouseUp,e),T&&(document.addEventListener(t.mouseMove,this.handleMouseMove,e),document.addEventListener(t.mouseUp,this.handleMouseUp,e)))}},{key:"componentDidUpdate",value:function(e,t){this.props.image&&this.props.image!==e.image||this.props.width!==e.width||this.props.height!==e.height||this.props.backgroundColor!==e.backgroundColor?this.loadImage(this.props.image):this.props.image||t.image===se||this.clearImage();var n=this.canvas.getContext("2d");n.clearRect(0,0,this.canvas.width,this.canvas.height),this.paint(n),this.paintImage(n,this.state.image,this.props.border),e.image===this.props.image&&e.width===this.props.width&&e.height===this.props.height&&e.position===this.props.position&&e.scale===this.props.scale&&e.rotate===this.props.rotate&&t.my===this.state.my&&t.mx===this.state.mx&&t.image.x===this.state.image.x&&t.image.y===this.state.image.y&&t.backgroundColor===this.state.backgroundColor||this.props.onImageChange()}},{key:"componentWillUnmount",value:function(){var e;document&&(e=V.native,document.removeEventListener(e.move,this.handleMouseMove,!1),document.removeEventListener(e.up,this.handleMouseUp,!1),T&&(document.removeEventListener(e.mouseMove,this.handleMouseMove,!1),document.removeEventListener(e.mouseUp,this.handleMouseUp,!1)))}},{key:"isVertical",value:function(){return!this.props.disableCanvasRotation&&this.props.rotate%180!=0}},{key:"getBorders",value:function(e){var t=0<arguments.length&&e!==void 0?e:this.props.border;return Array.isArray(t)?t:[t,t]}},{key:"getDimensions",value:function(){var e=this.props,t=e.width,n=e.height,r=e.rotate,l=e.border,m={},g=E(this.getBorders(l),2),b=g[0],O=g[1],R=t,H=n;return this.isVertical()?(m.width=H,m.height=R):(m.width=R,m.height=H),m.width+=2*b,m.height+=2*O,{canvas:m,rotate:r,width:t,height:n,border:l}}},{key:"getImage",value:function(){var e=this.getCroppingRect(),t=this.state.image;e.x*=t.resource.width,e.y*=t.resource.height,e.width*=t.resource.width,e.height*=t.resource.height;var n=document.createElement("canvas");this.isVertical()?(n.width=e.height,n.height=e.width):(n.width=e.width,n.height=e.height);var r=n.getContext("2d");return r.translate(n.width/2,n.height/2),r.rotate(this.props.rotate*Math.PI/180),r.translate(-n.width/2,-n.height/2),this.isVertical()&&r.translate((n.width-n.height)/2,(n.height-n.width)/2),t.backgroundColor&&(r.fillStyle=t.backgroundColor,r.fillRect(-e.x,-e.y,t.resource.width,t.resource.height)),r.drawImage(t.resource,-e.x,-e.y),n}},{key:"getImageScaledToCanvas",value:function(){var e=this.getDimensions(),t=e.width,n=e.height,r=document.createElement("canvas");return this.isVertical()?(r.width=n,r.height=t):(r.width=t,r.height=n),this.paintImage(r.getContext("2d"),this.state.image,0,1),r}},{key:"getXScale",value:function(){var e=this.props.width/this.props.height,t=this.state.image.width/this.state.image.height;return Math.min(1,e/t)}},{key:"getYScale",value:function(){var e=this.props.height/this.props.width,t=this.state.image.height/this.state.image.width;return Math.min(1,e/t)}},{key:"getCroppingRect",value:function(){var e=this.props.position||{x:this.state.image.x,y:this.state.image.y},t=1/this.props.scale*this.getXScale(),n=1/this.props.scale*this.getYScale(),r={x:e.x-t/2,y:e.y-n/2,width:t,height:n},l=0,m=1-r.width,g=0,b=1-r.height;return(this.props.disableBoundaryChecks||1<t||1<n)&&(l=-r.width,g=-r.height,b=m=1),L(L({},r),{},{x:Math.max(l,Math.min(r.x,m)),y:Math.max(g,Math.min(r.y,b))})}},{key:"loadImage",value:function(e){var t;z&&e instanceof File?this.loadingImage=(t=e,new Promise(function(n,r){var l=new FileReader;l.onload=function(m){try{var g=y(m.target.result);n(g)}catch(b){r(b)}},l.readAsDataURL(t)}).then(this.handleImageReady).catch(this.props.onLoadFailure)):typeof e=="string"&&(this.loadingImage=y(e,this.props.crossOrigin).then(this.handleImageReady).catch(this.props.onLoadFailure))}},{key:"getInitialSize",value:function(e,t){var n,r,l=this.getDimensions();return t/e<l.height/l.width?r=e*((n=this.getDimensions().height)/t):n=t*((r=this.getDimensions().width)/e),{height:n,width:r}}},{key:"paintImage",value:function(e,t,n,r){var l,m=3<arguments.length&&r!==void 0?r:A;t.resource&&(l=this.calculatePosition(t,n),e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(this.props.rotate*Math.PI/180),e.translate(-e.canvas.width/2,-e.canvas.height/2),this.isVertical()&&e.translate((e.canvas.width-e.canvas.height)/2,(e.canvas.height-e.canvas.width)/2),e.scale(m,m),e.globalCompositeOperation="destination-over",e.drawImage(t.resource,l.x,l.y,l.width,l.height),t.backgroundColor&&(e.fillStyle=t.backgroundColor,e.fillRect(l.x,l.y,l.width,l.height)),e.restore())}},{key:"calculatePosition",value:function(e,t){e=e||this.state.image;var n=E(this.getBorders(t),2),r=n[0],l=n[1],m=this.getCroppingRect(),g=e.width*this.props.scale,b=e.height*this.props.scale,O=-m.x*g,R=-m.y*b;return this.isVertical()?(O+=l,R+=r):(O+=r,R+=l),{x:O,y:R,height:b,width:g}}},{key:"paint",value:function(e){e.save(),e.scale(A,A),e.translate(0,0),e.fillStyle="rgba("+this.props.color.slice(0,4).join(",")+")";var t,n,r,l,m,g,b,O,$=this.props.borderRadius,R=this.getDimensions(),H=E(this.getBorders(R.border),2),J=H[0],Z=H[1],q=R.canvas.height,N=R.canvas.width,$=Math.max($,0);$=Math.min($,N/2-J,q/2-Z),e.beginPath(),t=e,l=N-2*(n=J),m=q-2*(r=Z),(g=$)===0?t.rect(n,r,l,m):(b=l-g,O=m-g,t.translate(n,r),t.arc(g,g,g,Math.PI,1.5*Math.PI),t.lineTo(b,0),t.arc(b,g,g,1.5*Math.PI,2*Math.PI),t.lineTo(l,O),t.arc(b,O,g,2*Math.PI,.5*Math.PI),t.lineTo(g,m),t.arc(g,O,g,.5*Math.PI,Math.PI),t.translate(-n,-r)),e.rect(N,0,-N,q),e.fill("evenodd"),e.restore()}},{key:"render",value:function(){var e=this.props,t=(e.scale,e.rotate,e.image,e.border,e.borderRadius,e.width,e.height,e.position,e.color,e.backgroundColor,e.style),n=(e.crossOrigin,e.onLoadFailure,e.onLoadSuccess,e.onImageReady,e.onImageChange,e.onMouseUp,e.onMouseMove,e.onPositionChange,e.disableBoundaryChecks,e.disableHiDPIScaling,e.disableCanvasRotation,W(e,["scale","rotate","image","border","borderRadius","width","height","position","color","backgroundColor","style","crossOrigin","onLoadFailure","onLoadSuccess","onImageReady","onImageChange","onMouseUp","onMouseMove","onPositionChange","disableBoundaryChecks","disableHiDPIScaling","disableCanvasRotation"])),r=this.getDimensions(),l={width:r.canvas.width,height:r.canvas.height,cursor:this.state.drag?"grabbing":"grab",touchAction:"none"},m={width:r.canvas.width*A,height:r.canvas.height*A,style:L(L({},l),t)};return m[V.react.down]=this.handleMouseDown,T&&(m[V.react.mouseDown]=this.handleMouseDown),I.default.createElement("canvas",S({ref:this.setCanvas},m,n))}}])&&M(o.prototype,d),h}();return w(oe,"propTypes",{scale:s.default.number,rotate:s.default.number,image:s.default.oneOfType([s.default.string].concat(function(o){if(Array.isArray(o))return x(o)}(U=z?[s.default.instanceOf(File)]:[])||function(o){if(typeof Symbol<"u"&&Symbol.iterator in Object(o))return Array.from(o)}(U)||F(U)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}())),border:s.default.oneOfType([s.default.number,s.default.arrayOf(s.default.number)]),borderRadius:s.default.number,width:s.default.number,height:s.default.number,position:s.default.shape({x:s.default.number,y:s.default.number}),color:s.default.arrayOf(s.default.number),backgroundColor:s.default.string,crossOrigin:s.default.oneOf(["","anonymous","use-credentials"]),onLoadFailure:s.default.func,onLoadSuccess:s.default.func,onImageReady:s.default.func,onImageChange:s.default.func,onMouseUp:s.default.func,onMouseMove:s.default.func,onPositionChange:s.default.func,disableBoundaryChecks:s.default.bool,disableHiDPIScaling:s.default.bool,disableCanvasRotation:s.default.bool}),w(oe,"defaultProps",{scale:1,rotate:0,border:25,borderRadius:0,width:200,height:200,color:[0,0,0,.5],onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){},disableBoundaryChecks:!1,disableHiDPIScaling:!1,disableCanvasRotation:!0}),oe})})(Ae);var Mt=Ae.exports;const kt=ze(Mt);function Pt({name:u,src:f}){const v=K.useRef(),p=K.useRef(),[c,s]=K.useState(null),{isOpen:I,onOpen:M,onClose:w}=me(),S=async()=>{if(p.current){const k=p.current.getImage().toDataURL();it.post(lt+"/upload",{images:[k]})}};return a.jsxs(a.Fragment,{children:[a.jsx(we,{rounded:"md",cursor:"pointer",onClick:M,size:"2xl",src:f||void 0,name:u}),a.jsxs(pe,{autoFocus:!1,isOpen:I,onClose:w,onCloseComplete:()=>s(null),closeOnOverlayClick:!1,children:[a.jsx(ge,{}),a.jsxs(fe,{children:[a.jsx(ut,{}),a.jsx(ve,{children:"Foto Profil Kamu"}),a.jsxs(xe,{py:"0",as:he,children:[a.jsx(de,{boxSize:"250px",rounded:"xl",overflow:"hidden",outline:c?"3px solid":"",outlineColor:"yellow.400",children:c?a.jsx(kt,{ref:p,image:URL.createObjectURL(c),width:250,height:250,border:0,color:[255,255,255,.6],rotate:0}):a.jsx(we,{rounded:"0",size:"2xl",mx:"auto",boxSize:"full",aspectRatio:1,src:f||void 0,name:u})}),a.jsxs(X,{alignSelf:"start",children:[a.jsx(ct,{size:"18"}),a.jsx(le,{children:c?"Paskan Foto dengan menggesernya":f?"Foto profil anda terlihat keren":"Anda Belum mengatur foto profil, Ayo atur sekarang"})]})]}),a.jsxs(ye,{as:X,children:[!!f&&a.jsx(D,{leftIcon:a.jsx(dt,{size:"18"}),colorScheme:"red",children:"Hapus"}),a.jsx(Re,{}),a.jsx(D,{colorScheme:"orange",leftIcon:a.jsx(Be,{size:"18"}),onClick:()=>{v.current&&v.current.click()},children:"Ubah"}),!!c&&a.jsx(D,{type:"submit",colorScheme:"blue",onClick:S,children:"Simpan"}),a.jsx(ce,{ref:v,type:"file",display:"none",accept:"image/*",id:"upload",onChange:k=>k.target.files?s(k.target.files[0]):null})]})]})]})]})}function aa(){const u=We(),{user:f,roleIs:v}=Oe(),p=u.pathname=="/account",c=p?f.userId:Se().id,{data:s,mutate:I,error:M}=qe(`/users/${c}`,Ge);if(M)throw M;return s?a.jsxs(de,{children:[a.jsx(Ne,{Icon:a.jsx(Ye,{}),text:"Detail Akun"}),a.jsxs(Ve,{mt:"8",maxW:"container.md",children:[a.jsxs(X,{spacing:"6",children:[a.jsx(Pt,{name:s.name,src:s.profilePicture}),a.jsxs(de,{children:[a.jsx(Ze,{value:s.role}),a.jsx(He,{mb:"1",fontSize:"2xl",children:s.name}),a.jsxs(X,{children:[a.jsx(xt,{size:"16"}),a.jsx(Ce,{href:"mailto:"+s.email,children:s.email})]}),a.jsxs(X,{children:[a.jsx(ht,{size:"16"}),a.jsx(Ce,{href:"tel:"+s.phone,children:s.phone})]})]}),a.jsx(Re,{}),(p||v("admin"))&&a.jsx(It,{colorScheme:"blue",alignSelf:"start",leftIcon:a.jsx(Be,{size:"16"}),children:"Sunting Profil",data:s,mutate:I})]}),a.jsx(te,{IconEl:mt,children:"Alamat"}),a.jsx(le,{children:s.address}),a.jsx(te,{IconEl:pt,children:"Deskripsi pengguna"}),a.jsx(le,{fontStyle:s.description?"normal":"italic",color:s.description?"inherit":"gray.500",children:s.description||"Tidak Ada Deskripsi pengguna"}),!p&&a.jsxs(a.Fragment,{children:[s.role=="manager"&&a.jsxs(a.Fragment,{children:[a.jsxs(te,{IconEl:Ie,children:["Perusahaan Anda",a.jsx(ke,{colorScheme:"blue",ml:"2",children:s.countManagedCompany||0})]}),v("admin")&&a.jsx(_e,{to:"/companies/create",children:a.jsx(D,{colorScheme:"blue",leftIcon:a.jsx(Me,{size:"18"}),children:"Tambahkan Perusahaan"})}),a.jsx(Qe,{mt:"4",data:s,mutate:I})]}),s.role=="regular"&&a.jsxs(a.Fragment,{children:[a.jsxs(te,{IconEl:Ie,children:["Node yang Ikuti",a.jsx(ke,{colorScheme:"blue",ml:"2",children:s.countSubscribedNodes||0})]}),v("admin")&&a.jsx(X,{children:a.jsx(D,{colorScheme:"blue",leftIcon:a.jsx(Me,{size:"18"}),children:"Tambahkan Node"})}),a.jsx(et,{mt:"4",data:s,mutate:I})]})]}),(p||v("admin"))&&a.jsxs(a.Fragment,{children:[a.jsx(te,{IconEl:Je,children:"Autentikasi"}),a.jsxs(X,{justify:"space-between",children:[p&&a.jsx(Ct,{colorScheme:"yellow",data:s,children:"Ganti Kata Sandi"}),a.jsx(gt,{resource:"Pengguna",name:s.name,colorScheme:"red",deleteApiUrl:"/users/"+s.userId,redirectPath:"/users"})]})]})]})]}):a.jsx(Xe,{})}export{aa as default};
