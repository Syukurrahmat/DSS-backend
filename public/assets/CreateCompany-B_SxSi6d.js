import{r as F,j as a,L as A,M as N,T as M,F as W,V as q}from"./createReactComponent-WPW12zrK.js";import{F as T}from"./FormMapPicker-DiS8gQ-x.js";import{R as i}from"./RequiredIndicator-BSTyY86i.js";import{B as g}from"./BigAlert-B5jTSdtk.js";import{u as w,m as R,S as L,t as U,P as V,a as E,F as $}from"./app-BIM-v5sX.js";import{a as z}from"./common.utils-BDtzQ6xa.js";import{i as D,n as H,b as _,d as J,c as O}from"./validator.utils-C_TaQQBu.js";import{u as G,c as K,a as Q,F as n,b as t}from"./index.esm-BStM4cIJ.js";import{F as o,c as X,B as Y}from"./icon-white-BiuxQ1Ek.js";import{T as b}from"./chunk-4IH3O7BJ-s5k9DqCt.js";import"./index-_9iesu2c.js";import"./dateFormating-_VgpDya0.js";import"./index.tags-0kB2MkZx.js";import"./icon-BvDSS9q3.js";import"./TagWithIcon-DFTk4qIc.js";import"./IconCirclePlus-Fzp5W_0t.js";function xa(){const[f,l]=F.useState(),{user:k,roleIs:I}=w(),{role:B,userId:y}=k,p=B=="manager"?y:NaN,{handleChange:d,handleBlur:m,isSubmitting:S,setSubmitting:v,touched:r,errors:e,values:P,setStatus:h,status:c,resetForm:x,setFieldValue:j,handleSubmit:C}=G({initialValues:{managerId:p,name:"",type:"tofufactory",description:"",address:"",coordinate:[NaN,NaN]},validationSchema:K().shape({managerId:D.required("Wajib diisi"),name:H.required("Wajib diisi"),type:Q().required("Wajib diisi"),address:_.required("Wajib diisi"),description:J.required("Wajib diisi"),coordinate:O.required("Wajib diisi")}),onSubmit:s=>{R.post("/companies",z(s)).then(({data:u})=>{h({created:!0,companyId:u.data.companyId})}).catch(()=>h({created:!1})).finally(()=>v(!1))}});return a.jsxs(A,{children:[a.jsx(N,{size:"lg",children:"Buat Perusahaan"}),a.jsx(M,{children:"Buat Perusahaan dan dapatkan dukungan keputusan untuk perusahaan Anda"}),a.jsx(W,{maxW:"container.sm",mt:"6",children:c===void 0?a.jsx("form",{onSubmit:C,className:"my-form",children:a.jsxs(q,{mx:"auto",spacing:"2",children:[I("admin")&&a.jsxs(o,{isInvalid:!!e.managerId&&r.managerId,children:[a.jsxs(n,{children:["Pilih Manager ",a.jsx(i,{})]}),a.jsx(L,{leftIcon:a.jsx(U,{size:"30"}),itemName:"Manager",apiUrl:"/users?role=manager&view=simple",_value:f,_onChange:s=>{l(s),p||j("managerId",s.userId)},displayRow:s=>a.jsx(V,{name:s.name})}),a.jsx(t,{children:e.managerId})]}),a.jsxs(o,{isInvalid:!!e.name&&r.name,children:[a.jsxs(n,{children:["Nama Perusahaan ",a.jsx(i,{})]}),a.jsx(X,{id:"name",name:"name",placeholder:"Misal : Pabrik Bahagia",onChange:d,onBlur:m}),a.jsx(t,{children:e.name})]}),a.jsxs(o,{isInvalid:!!e.type&&r.type,children:[a.jsxs(n,{children:["Jenis Perusahaan ",a.jsx(i,{})]}),a.jsx(E,{id:"type",name:"type",onChange:d,onBlur:m,bg:"white",children:Object.entries($).map(([s,u])=>a.jsx("option",{value:s,children:u.name},s))}),a.jsx(t,{children:e.type})]}),a.jsxs(o,{isInvalid:!!e.address&&r.address,children:[a.jsxs(n,{children:["Alamat Pabrik ",a.jsx(i,{})]}),a.jsx(b,{id:"address",name:"address",placeholder:"Masukkan Alamat Pabrik",onChange:d,onBlur:m}),a.jsx(t,{children:e.address})]}),a.jsxs(o,{isInvalid:!!e.description&&r.description,children:[a.jsxs(n,{children:["Deskripsi ",a.jsx(i,{})]}),a.jsx(b,{id:"description",name:"description",placeholder:"Masukkan deskripsi pabrik",onChange:d,onBlur:m}),a.jsx(t,{children:e.description})]}),a.jsx(T,{errors:e.coordinate,touched:r.coordinate,values:P.coordinate,setFieldValue:j}),a.jsx(Y,{isLoading:S,w:"full",mt:"4",colorScheme:"green",type:"submit",children:"Buat Perusahaan"})]})}):c.created?a.jsx(g,{status:"success",title:"Perusahaan berhasil dibuat",description:"Tambah Node baik indoor maupun outdoor untuk mendapatkan informasi dan rekomendasi seputar kualiats udara dan emisi gas rumah kaca",onCreateAgain:()=>{x(),l(void 0)},itemName:"perusahaan",detailPageURL:`/companies/${c.companyId}`}):a.jsx(g,{status:"warning",title:"Perusahaan gagal didaftarkan",description:"Ada yang salah. Hubungi Administrator",onCreateAgain:()=>{x(),l(void 0)}})})]})}export{xa as default};
