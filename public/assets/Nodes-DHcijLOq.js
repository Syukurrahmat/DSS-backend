import{j as e,H as l,C as f,V as b,T as n,N as C,L as D}from"./createReactComponent-m2GCamtz.js";import{u as V,k as y,p as z,L as k,z as I,r as G,G as H,v as g,O as L,P as v,H as w,U as P,C as M,V as W,J as F}from"./app-BlQRCkbL.js";import{M as U}from"./index-Dt6lv0Jl.js";import{b as B}from"./index.tags-vBYpzwqj.js";import{G as A}from"./GMapsButton-CMg_SpqN.js";import{H as K}from"./HeadingWithIcon-DsJVocdS.js";import{u as E}from"./useHashBasedTabsIndex-Dzc-MKf8.js";import{t as O}from"./dateFormating-CjiM6gKV.js";import{I as R}from"./IconPlus-Bm6anzmS.js";import{I as J}from"./IconExternalLink-pP3M5HlB.js";import{F as u}from"./chunk-KRPLQIP4-1nj_ibqy.js";import{G as _}from"./chunk-JARCRF6W-CeVJ6vdb.js";import{T as q,a as Q,b as h,c as X,d as j}from"./chunk-IAXSQ4X2-BWbuaJl8.js";import"./TagWithIcon-BmQxVHBm.js";import"./chunk-V7PAE35Z-BuEgg6Tf.js";import"./chunk-K7XRJ7NL-DVxbvYYn.js";import"./index-B4MCLp8v.js";const t=F(),T=[t.accessor("name",{header:"Nama",cell:a=>a.getValue()}),t.accessor("status",{header:"Status",cell:a=>e.jsx(B,{value:a.getValue()})}),t.accessor("coordinate",{header:"Koordinat",cell:a=>e.jsx(A,{coordinate:a.getValue()})}),t.accessor("lastDataSent",{header:"Terakhir data dikirim",cell:a=>O(a.getValue())||"-"}),t.accessor("nodeId",{header:"Aksi",cell:a=>e.jsxs(l,{children:[a.row.original.owner&&e.jsx(g,{to:"/companies/"+a.row.original.owner.companyId,children:e.jsx(f,{colorScheme:"green",size:"sm",leftIcon:e.jsx(P,{size:"16"}),children:"Lihat Usaha"})}),e.jsx(g,{to:"/nodes/"+a.getValue(),children:e.jsx(f,{colorScheme:"blue",size:"sm",leftIcon:e.jsx(J,{size:"16"}),children:"Detail"})})]})})],Y=[t.accessor("owner",{header:"Usaha",cell:a=>e.jsxs(l,{children:[e.jsx(M,{type:a.getValue().type}),e.jsx(n,{children:a.getValue().name})]})}),,...T.filter(a=>a.accessorKey!=="coordinate")];function je(){const[a,x]=E(["public","private","map"]),{roleIs:s}=V(),{data:r}=y("/nodes/summary",z);return r?e.jsxs(u,{gap:"2",flexDir:"column",children:[e.jsxs(l,{w:"full",spacing:"4",align:"start",children:[e.jsx(K,{Icon:e.jsx(I,{}),text:"Daftar Node"}),e.jsx(G,{}),e.jsx(H,{w:"200px",bg:"white",placeholder:"Cari ..",_onSubmit:null}),s("admin")&&e.jsx(g,{to:"./create",children:e.jsx(f,{leftIcon:e.jsx(R,{size:"20px"}),colorScheme:"green",children:"Tambah Node"})})]}),e.jsxs(u,{gap:"3",direction:["column","row"],justify:"space-between",flexWrap:"wrap",children:[e.jsxs(b,{flex:"0 0 180px",bg:"blue.400",p:"2",rounded:"md",color:"white",spacing:"0",justify:"center",children:[e.jsxs(l,{fontSize:"3xl",children:[e.jsx(I,{}),e.jsx(n,{fontWeight:"600",children:r.all})]}),e.jsx(n,{children:"Total Node"})]}),e.jsx(u,{flex:"1 1 0",gap:"3",children:[{label:"Kepemilikan Node",data:r.ownership,flex:"2 0 30px"},{label:"Status Node",data:r.status,flex:"3 0 30px"}].map(({label:c,data:p,flex:m})=>e.jsxs(C,{flex:m,pb:"2",rounded:"md",px:"3",border:"1px solid",borderColor:"gray.300",children:[e.jsx(n,{fontWeight:"600",py:"1",children:c}),e.jsx(_,{gap:"3",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",children:p.map((d,o)=>{const{color:i,name:S,icon:N}={...L,...v}[d.value];return e.jsxs(b,{bg:i+".50",border:"2px solid",rounded:"md",p:"1",spacing:"0",borderColor:i+".200",children:[e.jsxs(l,{spacing:"3",children:[e.jsx(D,{color:i+".500",as:N,boxSize:"28px"}),e.jsx(n,{fontSize:"2xl",fontWeight:"600",children:d.count})]}),e.jsx(n,{fontWeight:"600",children:S})]},"s"+o)})})]},c))})]}),e.jsxs(q,{display:"flex",flexDir:"column",flexGrow:"1",index:a,onChange:x,isLazy:!0,children:[e.jsxs(Q,{children:[e.jsx(h,{children:"Daftar Node Public"}),e.jsx(h,{children:"Daftar Node Private"}),e.jsx(h,{children:"Lihat Dalam Maps"})]}),e.jsxs(X,{flexGrow:"1",children:[e.jsx(j,{px:"0",children:e.jsx(w,{flexGrow:"1",apiUrl:"/nodes?ownship=public",columns:T})}),e.jsx(j,{px:"0",children:e.jsx(w,{flexGrow:"1",apiUrl:"/nodes?ownship=private",columns:Y})}),e.jsx(j,{px:"0",h:"100%",children:e.jsx(Z,{})})]})]})]}):e.jsx(k,{})}function Z(){const{data:a}=y("/nodes?all=true",W);if(!a)return"loading slurr";const x=Object.values(a.result.filter(s=>s.companyId&&s.owner).reduce((s,r)=>{const{coordinate:c,owner:p,...m}=r,{name:d,companyId:o,type:i}=p;return s[o]||(s[o]={name:d,companyId:o,type:i,coordinate:c,indoorNodes:[]}),s[o].indoorNodes.push(m),s},{}));return e.jsx(U,{h:"100%",minH:"350px",companiesData:x,data:a.result.filter(s=>!s.companyId)})}export{je as default};
