import{j as e,L as C,T as h}from"./createReactComponent-WPW12zrK.js";import{u as L,b as y,f as I,L as V,y as j,q as H,H as G,v as f,Q as P,T as M,J as b,C as W,K as B}from"./app-BIM-v5sX.js";import{M as z}from"./index-_9iesu2c.js";import{b as A}from"./index.tags-0kB2MkZx.js";import{G as U}from"./GMapsButton-BNhdlxRZ.js";import{H as F}from"./HeadingWithIcon-FWn3pFPO.js";import{u as K,S as g}from"./useHashBasedTabsIndex-DZm6VBjZ.js";import{a as E}from"./dateFormating-_VgpDya0.js";import{I as O}from"./IconPlus-BqBe7j0q.js";import{I as R}from"./IconExternalLink-BPR0Htc5.js";import{F as p}from"./chunk-KRPLQIP4-BfVHV2g3.js";import{H as T}from"./icon-BvDSS9q3.js";import{B as N}from"./icon-white-BiuxQ1Ek.js";import{G as q}from"./chunk-JARCRF6W-DZGTgXcm.js";import{T as J,a as Q,b as x}from"./chunk-4YMKQ5D4-CC--TXWK.js";import{T as _,a as X}from"./chunk-IAXSQ4X2-WIPLwa7a.js";import"./TagWithIcon-DFTk4qIc.js";import"./chunk-K7XRJ7NL-C_5srjpV.js";const r=B(),u=[r.accessor("name",{header:"Nama",cell:a=>a.getValue()}),r.accessor("isUptodate",{header:"Status",cell:a=>e.jsx(A,{value:a.getValue()})}),r.accessor("address",{header:"Alamat",cell:a=>e.jsx(h,{noOfLines:2,whiteSpace:"wrap",children:a.getValue()})}),r.accessor("coordinate",{header:"Koordinat",cell:a=>e.jsx(U,{coordinate:a.getValue()})}),r.accessor("lastDataSent",{header:"Terakhir data dikirim",cell:a=>E(a.getValue())||"-"}),r.accessor("nodeId",{header:"Aksi",cell:a=>e.jsx(f,{to:"/nodes/"+a.getValue(),children:e.jsx(N,{colorScheme:"blue",size:"sm",leftIcon:e.jsx(R,{size:"16"}),children:"Detail"})})})],Y=[...u.slice(0,2),r.accessor("owner",{header:"Perusahaan",cell:a=>e.jsx(f,{to:"/companies/"+a.getValue().companyId,children:e.jsxs(T,{children:[e.jsx(W,{type:a.getValue().type}),e.jsx(h,{children:a.getValue().name})]})})}),...u.slice(4)],w=[{label:"Daftar Node Publik",key:"public"},{label:"Daftar Node Privat",key:"private"},{label:"Lihat Dalam Maps",key:"map"}];function je(){const{roleIs:a}=L(),l=a("manager")?[w[1]]:w,[s,d]=K(l.map(o=>o.key)),{data:t}=y("/nodes/overview",I);if(!t)return e.jsx(V,{});const i=[{label:"Status Node",data:t.status,flex:"1 0 30px"}];return a("manager")||i.unshift({label:"Kepemilikan Node",data:t.ownership,flex:"1 0 30px"}),e.jsxs(p,{gap:"2",flexDir:"column",children:[e.jsxs(T,{w:"full",spacing:"4",align:"start",children:[e.jsx(F,{Icon:e.jsx(j,{}),text:"Daftar Node"}),e.jsx(H,{}),e.jsx(G,{w:"200px",bg:"white",placeholder:"Cari ..",_onSubmit:null}),a(["admin","manager"])&&e.jsx(f,{to:"./create",children:e.jsx(N,{leftIcon:e.jsx(O,{size:"20px"}),colorScheme:"green",children:"Tambah Node"})})]}),e.jsxs(p,{gap:"3",direction:["column","row"],justify:"space-between",flexWrap:"wrap",children:[e.jsx(g,{flex:"0 0 180px",icon:j,count:t.all,label:"Total Node",h:"full",variant:"solid",bg:"blue.400"}),e.jsx(p,{flex:"1 1 0",gap:"3",children:i.map(({label:o,data:m,flex:n})=>e.jsxs(C,{flex:n,maxW:"600px",pb:"2",rounded:"md",px:"3",border:"1px solid",borderColor:"gray.300",children:[e.jsx(h,{fontWeight:"600",py:"1",children:o}),e.jsx(q,{gap:"3",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",children:m.map((c,S)=>{const{color:k,name:D,icon:v}={...P,...M}[c.value];return e.jsx(g,{flex:"1 0 180px",icon:v,color:k,count:c.count,label:D},S)})})]},o))})]}),e.jsxs(J,{display:"flex",flexDir:"column",flexGrow:"1",index:s,onChange:d,isLazy:!0,children:[e.jsx(_,{children:l.map(o=>e.jsx(X,{children:o.label},o.key))}),e.jsxs(Q,{flexGrow:"1",children:[e.jsx(x,{px:"0",children:e.jsx(b,{flexGrow:"1",apiUrl:"/nodes?ownship=public",columns:u})}),e.jsx(x,{px:"0",children:e.jsx(b,{flexGrow:"1",apiUrl:"/nodes?ownship=private",columns:Y})}),e.jsx(x,{px:"0",h:"100%",children:e.jsx(Z,{})})]})]})]})}function Z(){const{data:a}=y("/nodes?all=true",I);if(!a)return"loading slurr";const l=Object.values(a.rows.filter(s=>s.companyId&&s.owner).reduce((s,d)=>{const{coordinate:t,owner:i,...o}=d,{name:m,companyId:n,type:c}=i;return s[n]||(s[n]={name:m,companyId:n,type:c,coordinate:t,indoorNodes:[]}),s[n].indoorNodes.push(o),s},{}));return e.jsx(z,{h:"100%",minH:"350px",companiesData:l,data:a.rows.filter(s=>!s.companyId)})}export{Y as columPrivateNodeTable,je as default};
