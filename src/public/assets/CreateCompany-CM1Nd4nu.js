import{r as j,D as E,j as a,N as F,J as M,T as U,E as v,V as T,Z as r,Q as W,a1 as q,a2 as P,C as R}from"./createReactComponent-m2GCamtz.js";import{R as n}from"./RequiredIndicator-DdPXie2d.js";import{M as V}from"./index-Dt6lv0Jl.js";import{B as g}from"./BigAlert-ClPlFLp7.js";import{N as w}from"./NamewithAvatar-CIkhhQ32.js";import{u as L,c as $,S as D,t as H,i as O,F as _}from"./app-BlQRCkbL.js";import{a as z}from"./common.utils-BXgvsAbj.js";import{i as J,n as G,b as K,d as Q,c as Z}from"./validator.utils-BSOb9322.js";import{u as X}from"./formik.esm-X4pWCQgU.js";import{c as Y,a as aa,F as t,b as o}from"./index.esm-DXWgZSHY.js";import{T as b}from"./chunk-4IH3O7BJ-BSUfzZnZ.js";import"./dateFormating-CjiM6gKV.js";import"./index.tags-vBYpzwqj.js";import"./TagWithIcon-BmQxVHBm.js";import"./chunk-V7PAE35Z-BuEgg6Tf.js";import"./IconCirclePlus-D9W8Q483.js";function ga(){const{user:f,roleIs:k}=L(),{role:I,userId:B}=f,[d,y]=j.useState({}),C=I=="manager"?B:"",{handleChange:l,handleBlur:m,isSubmitting:N,setSubmitting:A,touched:i,errors:e,setStatus:p,status:c,resetForm:h,setFieldValue:x,handleSubmit:S}=X({initialValues:{managerId:C,name:"",type:"tofufactory",description:"",address:"",coordinate:[NaN,NaN]},validationSchema:Y().shape({managerId:J.required("Wajib diisi"),name:G.required("Wajib diisi"),type:aa().required("Wajib diisi"),address:K.required("Wajib diisi"),description:Q.required("Wajib diisi"),coordinate:Z.required("Wajib diisi")}),onSubmit:s=>{$.post(`${E}/companies`,z(s)).then(({data:u})=>p(u||!1)).catch(()=>p(!1)).finally(()=>A(!1))}});return j.useEffect(()=>{x("managerId",d==null?void 0:d.userId)},[d]),a.jsxs(F,{children:[a.jsx(M,{size:"lg",children:"Buat Usaha"}),a.jsx(U,{children:"Buat Usaha untuk dashboard suatu pabrik"}),a.jsx(v,{maxW:"container.sm",mt:"6",children:c!==void 0?c?a.jsx(g,{status:"success",title:"Usaha berhasil dibuat",description:"Tambah Node baik indoor maupun outdoor untuk mendapatkan informasi dan rekomendasi seputar kualiats udara dan emisi gas rumah kaca",onCreateAgain:h,itemName:"usaha",detailPageURL:`/companies/${c.result.companyId}`}):a.jsx(g,{status:"warning",title:"Usaha gagal didaftarkan",description:"Ada yang salah. Hubungi Administrator",onCreateAgain:h}):a.jsx("form",{onSubmit:S,className:"my-form",children:a.jsxs(T,{mx:"auto",spacing:"2",children:[k("admin")&&a.jsxs(r,{isInvalid:!!e.managerId&&i.managerId,children:[a.jsxs(t,{children:["Pilih Manager ",a.jsx(n,{})]}),a.jsx(D,{leftIcon:a.jsx(H,{size:"30"}),itemName:"Manager",apiUrl:"/search/users?role=manager",selectValue:d,selectOnChange:y,displayRow:s=>a.jsx(w,{name:s.name})}),a.jsx(o,{children:e.managerId})]}),a.jsxs(r,{isInvalid:!!e.name&&i.name,children:[a.jsxs(t,{children:["Nama Usaha ",a.jsx(n,{})]}),a.jsx(W,{id:"name",name:"name",placeholder:"Misal : Pabrik Bahagia",onChange:l,onBlur:m}),a.jsx(o,{children:e.name})]}),a.jsxs(r,{isInvalid:!!e.type&&i.type,children:[a.jsxs(t,{children:["Jenis Usaha ",a.jsx(n,{})]}),a.jsx(O,{id:"type",name:"type",onChange:l,onBlur:m,bg:"white",children:Object.entries(_).map(([s,u])=>a.jsx("option",{value:s,children:u.name},s))}),a.jsx(o,{children:e.type})]}),a.jsxs(r,{isInvalid:!!e.address&&i.address,children:[a.jsxs(t,{children:["Alamat Pabrik ",a.jsx(n,{})]}),a.jsx(b,{id:"address",name:"address",placeholder:"Masukkan Alamat Pabrik",onChange:l,onBlur:m}),a.jsx(o,{children:e.address})]}),a.jsxs(r,{isInvalid:!!e.description&&i.description,children:[a.jsxs(t,{children:["Deskripsi ",a.jsx(n,{})]}),a.jsx(b,{id:"description",name:"description",placeholder:"Masukkan deskripsi pabrik",onChange:l,onBlur:m}),a.jsx(o,{children:e.description})]}),a.jsxs(r,{isInvalid:!!e.coordinate&&i.coordinate,children:[a.jsxs(t,{children:["Koordinat Node ",a.jsx(n,{})]}),a.jsx(q,{children:"Geser peta dan paskan penanda ke titik yang dimaksud"}),a.jsx(V,{mt:"3",data:[],outline:e.coordinate&&i.coordinate?"2px solid":"",outlineColor:"#E53E3E",isEditing:{coordinate:P,onChange:s=>x("coordinate",[s.lat,s.lng])}}),a.jsx(o,{children:e.coordinate})]}),a.jsx(R,{isLoading:N,w:"full",mt:"4",colorScheme:"green",type:"submit",children:"Buat Akun"})]})})})]})}export{ga as default};
