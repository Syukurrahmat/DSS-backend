import{K as P,r as v,D as V,j as e,C as E,V as W,Z as j,Q as S,H as h,T as D,N as I,J as q,R as z}from"./createReactComponent-m2GCamtz.js";import{S as H}from"./SectionTitle-CXF1AUe9.js";import{u as Y,b as U,j as l,c as $,m as J,M as _,d as G,e as Q,f as Z,g as X,i as ee,a1 as se,h as ae,k as te,p as ne,a2 as ie,a3 as oe,N as re}from"./app-BlQRCkbL.js";import{S as le,C as ce}from"./informationCard-CoG_vFyO.js";import{R as B}from"./RequiredIndicator-DdPXie2d.js";import{u as de}from"./useApiResponseToast-CR3ZylCY.js";import{a as me}from"./common.utils-BXgvsAbj.js";import{n as he,d as pe}from"./validator.utils-BSOb9322.js";import{u as ue}from"./formik.esm-X4pWCQgU.js";import{c as xe,a as F,F as g,b as f}from"./index.esm-DXWgZSHY.js";import{I as je}from"./IconPlus-Bm6anzmS.js";import{M as ge}from"./chunk-4FCEGNGT-DqvOsicM.js";import{T as fe}from"./chunk-4IH3O7BJ-BSUfzZnZ.js";import{S as O}from"./chunk-VTV6N5LE-DsG3bonO.js";import{E as De}from"./EventCalendar-CZfc3ekb.js";import{I as ye}from"./IconNotebookOff-DN5RGc3R.js";import{F as Ce}from"./chunk-KRPLQIP4-1nj_ibqy.js";import{T as be}from"./dateFormating-CjiM6gKV.js";import"./index.tags-vBYpzwqj.js";import"./IconMapPin-CWtp4fMu.js";import"./index-B4MCLp8v.js";import"./IconTrash-CmToVWU0.js";import"./IconEdit-DHHo-74T.js";import"./IconCalendar-DeQmHFDN.js";import"./chunk-YQO7BFFX-BRJMp5Lc.js";/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ke=P("outline","checklist","IconChecklist",[["path",{d:"M9.615 20h-2.615a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8",key:"svg-0"}],["path",{d:"M14 19l2 2l4 -4",key:"svg-1"}],["path",{d:"M9 8h4",key:"svg-2"}],["path",{d:"M9 12h2",key:"svg-3"}]]);function ve(){var R,K;const{user:M}=Y(),y=(K=(R=M.view)==null?void 0:R.company)==null?void 0:K.companyId,{isOpen:s,onOpen:T,onClose:p}=U(),{apiResponseToast:b}=de(),[i,k]=v.useState(!1),[o,c]=v.useState(!1),{handleChange:d,handleBlur:r,isSubmitting:u,values:t,setFieldValue:C,resetForm:w,touched:x,errors:n,handleSubmit:L}=ue({initialValues:{name:"",description:"",status:"inProgress",type:"production",location:"",startDate:l().format("YYYY-MM-DD"),endDate:l().format("YYYY-MM-DD"),isCompleted:!1},validationSchema:xe().shape({name:he.required("Wajib Diisi"),description:pe.required("Wajib Diisi"),type:F().required("Wajib Diisi"),status:F().required("Wajib Diisi"),location:F().nullable()}),onReset:()=>{k(!1),c(!1)},onSubmit:async a=>{a.endDate=i?a.startDate:o?null:a.endDate,me(a);const m=`/companies/${y}/events`;$.post(V+m,a).then(({data:N})=>{b(N,{onSuccess(){J(A=>typeof A=="string"&&A.startsWith(m)),p()}}),w()})}});return v.useEffect(()=>{l(t.endDate).isBefore(l(t.startDate))&&C("endDate",t.startDate)},[t.startDate]),v.useEffect(()=>{l(t.endDate).isAfter(l())&&C("isCompleted",!1)},[t.endDate]),e.jsxs(e.Fragment,{children:[e.jsx(E,{leftIcon:e.jsx(je,{size:"20px"}),colorScheme:"blue",children:"Tambah Catatan",onClick:T}),e.jsx(_,{size:"2xl",isOpen:s,onClose:p,scrollBehavior:"inside",closeOnEsc:!1,onCloseComplete:w,children:e.jsxs("form",{onSubmit:L,children:[e.jsx(G,{}),e.jsxs(Q,{children:[e.jsxs(Z,{borderBottom:"1px solid",borderColor:"gray.200",children:["Catat Kegiatan ",JSON.stringify(u)]}),e.jsx(ge,{}),e.jsx(X,{children:e.jsxs(W,{mx:"auto",spacing:"2",maxW:"container.sm",my:"4",children:[e.jsxs(j,{isInvalid:!!n.name&&x.name,children:[e.jsxs(g,{children:["Nama Kegiatan ",e.jsx(B,{})]}),e.jsx(S,{id:"name",name:"name",placeholder:"Misal : produksi tahu ",onChange:d,onBlur:r}),e.jsx(f,{children:n.name})]}),e.jsxs(j,{isInvalid:!!n.description&&x.description,children:[e.jsxs(g,{children:["Deskripsi Kegiatan ",e.jsx(B,{})]}),e.jsx(fe,{id:"description",name:"description",placeholder:"Tulis deskripsi kegiatan, singkat saja",onChange:d,onBlur:r}),e.jsx(f,{children:n.description})]}),e.jsxs(j,{isInvalid:!!n.location&&x.location,children:[e.jsx(g,{children:"Tempat Kegiatan"}),e.jsx(S,{id:"location",name:"location",placeholder:"Misal : Gudang ",onChange:d,onBlur:r}),e.jsx(f,{children:n.location})]}),e.jsxs(j,{isInvalid:!!n.type&&x.type,children:[e.jsxs(g,{children:["Jenis Usaha ",e.jsx(B,{})]}),e.jsx(ee,{id:"type",name:"type",onChange:d,onBlur:r,bg:"white",children:Object.entries(se).map(([a,m])=>e.jsx("option",{value:a,children:m.name},a))}),e.jsx(f,{children:n.type})]}),e.jsxs(h,{w:"full",align:"start",children:[e.jsxs(j,{isInvalid:!!n.startDate&&x.startDate,children:[e.jsxs(g,{children:["Tanggal dimulai ",e.jsx(B,{})]}),e.jsx(S,{id:"startDate",name:"startDate",type:"date",placeholder:"Misal : produksi tahu",value:t.startDate,onChange:d,onBlur:r}),e.jsxs(h,{as:"label",mt:"2",align:"center",cursor:"pointer",w:"fit-content",children:[e.jsx(O,{isChecked:i,onChange:a=>{const{checked:m}=a.target;k(m),m&&C("endDate",t.startDate)}}),e.jsx(D,{children:"Kegiatan hanya sehari"})]}),e.jsx(f,{children:n.startDate})]}),e.jsxs(j,{isInvalid:!!n.endDate&&x.endDate,children:[e.jsx(g,{children:"Tanggal berakhir"}),e.jsx(S,{id:"endDate",name:"endDate",type:"date",min:t.startDate,isDisabled:o||i,value:o?"":t.endDate||"",onChange:a=>C("endDate",a.target.value),onBlur:r}),e.jsx(h,{mt:"2",spacing:"4",children:e.jsxs(h,{as:"label",cursor:"pointer",w:"fit-content",children:[e.jsx(O,{isChecked:o&&!i,isDisabled:i||t.isCompleted,onChange:a=>c(a.target.checked)}),e.jsx(D,{color:i?"gray.400":"inherit",children:"Atur nanti"})]})}),e.jsx(f,{children:n.endDate})]})]}),e.jsxs(h,{alignSelf:"start",as:"label",cursor:"pointer",w:"fit-content",children:[e.jsx(O,{isChecked:t.isCompleted,isDisabled:l(t.endDate).startOf("d").isAfter(l()),onChange:a=>{C("isCompleted",a.target.checked)}}),e.jsx(D,{children:"Kegiatan sudah selesai"})]})]})}),e.jsxs(ae,{borderTop:"1px solid",borderColor:"gray.200",children:[e.jsx(E,{onClick:()=>{w(),p()},children:"Batal"}),e.jsx(E,{colorScheme:"blue",ml:3,type:"submit",isLoading:u,children:"Kirim"})]})]})]})})]})}function Ge(){var p,b;const{user:M}=Y(),y=(b=(p=M.view)==null?void 0:p.company)==null?void 0:b.companyId,{data:s}=te(y?`/companies/${y}/events/current`:null,ne);if(!y)return e.jsx(le,{});const T=[{title:"Kegiatan Berlangsung",icon:ie,count:s==null?void 0:s.inProgress.count,events:s==null?void 0:s.inProgress.events},{title:"Kegiatan Mendatang",icon:oe,count:s==null?void 0:s.upcoming.count,events:s==null?void 0:s.upcoming.events},{title:"Kegiatan Selesai",icon:ke,count:s==null?void 0:s.complete.count,events:s==null?void 0:s.complete.events,more:!0}];return e.jsxs(Ce,{gap:"3",children:[e.jsx(I,{flex:"1 1 0",position:"relative",h:"100%",w:"full",overflowY:"auto",className:"custom-scrollbar",children:e.jsxs(I,{position:"absolute",pr:"3",w:"full",children:[e.jsxs(h,{justify:"space-between",children:[e.jsxs(I,{children:[e.jsx(q,{size:"lg",children:"Pencatatan"}),e.jsx(D,{children:"Catat seluaruh kegiatan di pabrik Anda"})]}),e.jsx(ve,{})]}),T.map(({title:i,icon:k,count:o,events:c,more:d},r)=>e.jsxs(z.Fragment,{children:[e.jsxs(H,{IconEl:k,children:[i,!!o&&e.jsx(be,{children:o,ml:"2",colorScheme:"blue"})]}),e.jsx(W,{align:"stretch",children:c?c.length?e.jsxs(e.Fragment,{children:[c.map(u=>e.jsx(ce,{event:u},u.eventLogId)),d&&!!o&&e.jsxs(D,{mx:"auto",children:["Dan ",o-c.length," kegiatan terselesaikan lainnya"]})]}):e.jsxs(h,{justify:"center",color:"gray.500",py:"3",children:[e.jsx(ye,{stroke:"1.2",size:"40"}),e.jsxs(D,{fontWeight:"500",fontSize:"lg",children:["Tidak ada ",i]})]}):Array(3).fill(null).map((u,t)=>e.jsx(re,{h:"60.38px",w:"full"},t))})]},r))]})}),e.jsx(I,{flex:"1 1 0",minH:"100%",children:e.jsx(De,{})})]})}export{Ge as default};
