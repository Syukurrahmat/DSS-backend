import{K as V,r as u,j as e,H as c,C as o,T as S,V as q,N as T,L as H,J as P,D as R,U as Z,Z as F,Q as _,E as Y}from"./createReactComponent-m2GCamtz.js";import{W as ee,u as J,E as ae,r as $,H as W,c as w,m as se,b as ne,M as oe,d as ie,e as te,f as re,g as de,h as ce,q as le,k as me,p as ue,L as pe,F as he,z as xe,X as ge,x as je}from"./app-BlQRCkbL.js";import{H as fe}from"./HeadingWithIcon-DsJVocdS.js";import{S as D}from"./SectionTitle-CXF1AUe9.js";import{T as A}from"./TagWithIcon-BmQxVHBm.js";import{I as be,a as Ie,U as Se}from"./managerCard-CmoI7cC9.js";import{t as ye}from"./dateFormating-CjiM6gKV.js";import{g as Ce,a as ke}from"./commonColumn-BU8VaRKf.js";import{M as ve}from"./index-Dt6lv0Jl.js";import{A as Ne}from"./AddNodeSubscription-CF30erQV.js";import{G as Me}from"./GMapsButton-CMg_SpqN.js";import{u as K}from"./useApiResponseToast-CR3ZylCY.js";import{I as De}from"./IconUsersGroup-D7nlVQeI.js";import{I as Q}from"./IconEdit-DHHo-74T.js";import{I as Te,a as Be}from"./IconTrees-B9fr_ohZ.js";import{I as O}from"./IconCirclePlus-D9W8Q483.js";import{n as Ue,b as ze,d as Fe}from"./validator.utils-BSOb9322.js";import{c as Ae,F as E,b as L}from"./index.esm-DXWgZSHY.js";import{u as Ee}from"./formik.esm-X4pWCQgU.js";import{a as Le,c as Pe}from"./common.utils-BXgvsAbj.js";import{T as G}from"./chunk-4IH3O7BJ-BSUfzZnZ.js";import{I as Re}from"./IconCalendar-DeQmHFDN.js";import{a as $e,b as we}from"./IconTextCaption-DuaqrD48.js";import"./chunk-V7PAE35Z-BuEgg6Tf.js";import"./index.tags-vBYpzwqj.js";import"./IconTrash-CmToVWU0.js";import"./IconExternalLink-pP3M5HlB.js";import"./chunk-4FCEGNGT-DqvOsicM.js";import"./chunk-K7XRJ7NL-DVxbvYYn.js";/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var He=V("outline","tag","IconTag",[["path",{d:"M7.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M3 6v5.172a2 2 0 0 0 .586 1.414l7.71 7.71a2.41 2.41 0 0 0 3.408 0l5.592 -5.592a2.41 2.41 0 0 0 0 -3.408l-7.71 -7.71a2 2 0 0 0 -1.414 -.586h-5.172a3 3 0 0 0 -3 3z",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var We=V("outline","user-heart","IconUserHeart",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h.5",key:"svg-1"}],["path",{d:"M18 22l3.35 -3.284a2.143 2.143 0 0 0 .005 -3.071a2.242 2.242 0 0 0 -3.129 -.006l-.224 .22l-.223 -.22a2.242 2.242 0 0 0 -3.128 -.006a2.143 2.143 0 0 0 -.006 3.071l3.355 3.296z",key:"svg-2"}]]);function Oe(l){const{data:s,mutate:t}=l,a=ee(),[r,p]=u.useState(null),{apiResponseToast:y}=K(),[C,k]=u.useState(!1),[m,h]=u.useState(!1),[x,g]=u.useState(s.coordinate),{user:j,roleIs:n}=J(),B=ae(),{companyId:d}=s,f=`/companies/${d}/nodes`,b=`/companies/${d}/private-nodes`,U=i=>{const z=`${R+f}?subscriptionid=${i}`;B({title:"Hapus Pengikuti Node",message:"Anda yakin hendak menghapus node ini dari daftar langganan",confirmButtonColor:"red",onConfirm:()=>w.delete(z).then(({data:X})=>{se(I=>I&&I[0]==f),t(I=>(I.countSubscribedNodes-=1,I)),y(X)})})},v=async()=>{const i=`${R}/companies/${d}`;k(!0);const{data:z}=await w.put(i,{coordinate:x});k(!1),y(z,{onSuccess(){h(!1),t({...s,coordinate:x})}})},N=u.useMemo(()=>Ce(j.role,U),[]),M=u.useMemo(()=>ke(),[]);return e.jsxs(e.Fragment,{children:[e.jsx(D,{IconEl:De,children:"Lokasi Usaha dan Node yang dikuti"}),e.jsxs(c,{children:[!m&&e.jsxs(e.Fragment,{children:[e.jsx(Me,{size:"md",coordinate:s.coordinate,children:"Buka lokasi Usaha di Gmaps"}),e.jsx($,{}),n(["admin","manager"])&&e.jsx(o,{colorScheme:"yellow",leftIcon:e.jsx(Q,{size:"18"}),children:"Sunting lokasi usaha",onClick:()=>h(!0)})]}),m&&e.jsxs(e.Fragment,{children:[e.jsx(S,{fontSize:"sm",children:"Geser peta dan paskan penanda ke titik yang dimaksud"}),e.jsx($,{}),e.jsx(o,{colorScheme:"red",leftIcon:e.jsx(be,{size:"18"}),children:"Batal",onClick:()=>h(!1),isDisabled:C}),e.jsx(o,{colorScheme:"blue",leftIcon:e.jsx(Ie,{size:"18"}),children:"Simpan",isLoading:C,onClick:v})]})]}),e.jsxs(q,{align:"start",spacing:"6",children:[e.jsx(ve,{w:"full",my:"4",h:"300px",companiesData:r?[s]:[],data:r||[],outline:m?"3px solid":"",outlineColor:"orange.300",isEditing:m?{coordinate:s.coordinate,onChange:i=>g([i.lat,i.lng])}:void 0}),e.jsxs(c,{justify:"space-between",align:"start",w:"full",children:[e.jsxs(T,{children:[e.jsxs(c,{children:[e.jsx(H,{as:Te,boxSize:"20px"}),e.jsx(P,{size:"md",fontWeight:"600",children:"Node Indoor"})]}),e.jsxs(S,{children:["Daftar sensor yang terdapat di dalam ruangan usaha Anda"," ",s.countSubscribedNodes]})]}),n(["admin","manager"])&&e.jsx(o,{leftIcon:e.jsx(O,{size:"18"}),colorScheme:"blue",children:"Tambah Node Indoor",onClick:()=>a("./create-node",{state:{company:{name:s.name,companyId:s.companyId,type:s.type}}})})]}),e.jsx(W,{apiUrl:b,columns:M,emptyMsg:["Belum ada Node","Tambahkan Node sekarang"],hiddenPagination:!0}),e.jsxs(c,{justify:"space-between",align:"start",w:"full",children:[e.jsxs(T,{children:[e.jsxs(c,{children:[e.jsx(H,{as:Be,boxSize:"20px"}),e.jsx(P,{size:"md",fontWeight:"600",children:"Node Outdoor"})]}),e.jsx(S,{children:"Daftar sensor luar ruangan yang Anda ikuti"})]}),n(["admin","manager"])&&e.jsx(Ne,{subsInfo:{type:"company",companyData:s},children:e.jsx(o,{leftIcon:e.jsx(O,{size:"18"}),colorScheme:"blue",children:"Tambah Node outdoor"})})]}),e.jsx(W,{apiUrl:f,columns:N,setDataContext:p,emptyMsg:["Belum ada Node","Tambahkan Node sekarang"],hiddenPagination:!0})]})]})}function Ge({data:l,mutate:s,...t}){const{isOpen:a,onOpen:r,onClose:p}=ne(),{apiResponseToast:y}=K(),C=Z(),{name:k,description:m,address:h}=l,x={name:k,description:m,address:h},{handleChange:g,values:j,errors:n,handleSubmit:B,handleBlur:d,resetForm:f,touched:b,isSubmitting:U,setSubmitting:v}=Ee({initialValues:x,validationSchema:Ae().shape({name:Ue.required("Wajib diisi"),address:ze.required("Wajib diisi"),description:Fe.required("Wajib diisi")}),onSubmit:N=>{Le(N);const M=Pe(x,N);if(Object.keys(M).length===0){C({title:"Opss !!!",description:"Belum ada yang disunting",status:"warning"}),v(!1);return}w.put(R+"/groups/",{...M,groupId:l.groupId}).then(({data:i})=>{v(!1),y(i,{onSuccess(){s(null,{revalidate:!0}),p()}})})}});return e.jsxs(e.Fragment,{children:[e.jsx(o,{onClick:r,...t}),e.jsxs(oe,{size:"lg",autoFocus:!1,isOpen:a,onClose:p,onCloseComplete:f,closeOnOverlayClick:!1,children:[e.jsx(ie,{}),e.jsx(te,{children:e.jsxs("form",{onSubmit:B,className:"my-form",children:[e.jsx(re,{children:"Sunting Profil"}),e.jsx(de,{children:e.jsxs(q,{mx:"auto",spacing:"2",maxW:"container.sm",children:[e.jsxs(F,{isInvalid:!!n.name&&b.name,children:[e.jsx(E,{children:"Nama"}),e.jsx(_,{id:"name",name:"name",placeholder:"Misal : Suparna",onChange:g,onBlur:d,value:j.name}),e.jsx(L,{children:n.name})]}),e.jsxs(F,{isInvalid:!!n.address&&b.address,children:[e.jsx(E,{children:"Alamat"}),e.jsx(G,{id:"address",name:"address",placeholder:"Masukkan Alamat Tempat tinggal Pengguna",onChange:g,onBlur:d,value:j.address}),e.jsx(L,{children:n.address})]}),e.jsxs(F,{isInvalid:!!n.description&&b.description,children:[e.jsx(E,{children:"Description"}),e.jsx(G,{id:"description",name:"description",placeholder:"Opsional",onChange:g,onBlur:d,value:j.description}),e.jsx(L,{children:n.description})]})]})}),e.jsxs(ce,{children:[e.jsx(o,{variant:"ghost",onClick:p,children:"Batal"}),e.jsx(o,{isLoading:U,type:"submit",colorScheme:"blue",ml:3,children:"Submit"})]})]})})]})]})}function Ia(){const{id:l}=le(),{user:s,roleIs:t}=J(),{data:a,mutate:r}=me(`/companies/${l}`,ue);return a?e.jsxs(T,{children:[e.jsx(fe,{Icon:e.jsx(We,{}),text:"Detail Grup"}),e.jsxs(Y,{mt:"8",maxW:"container.md",children:[e.jsxs(c,{justify:"space-between",children:[e.jsxs(T,{children:[e.jsx(P,{fontSize:"3xl",children:a.name}),e.jsxs(c,{mt:"2",children:[e.jsx(A,{icon:Re,colorScheme:"blue",children:`Dibuat pada ${ye(a.createdAt)}`}),e.jsx(A,{icon:He,colorScheme:he[a.type].color,textTransform:"capitalize",children:a.type}),e.jsx(A,{icon:xe,children:a.countSubscribedNodes+" Node"})]}),["admin","gov"].includes(s.role)&&e.jsx(Se,{mt:"3",data:a.manager,label:"manager"})]}),e.jsx($,{}),e.jsx(ge,{alignSelf:"start",companyId:a.companyId}),t(["admin","manager"])&&e.jsx(Ge,{data:a,mutate:r,colorScheme:"blue",alignSelf:"start",leftIcon:e.jsx(Q,{size:"16"}),children:"Sunting Usaha"})]}),e.jsx(D,{IconEl:$e,children:"Alamat"}),e.jsx(S,{children:a.address}),e.jsx(D,{IconEl:we,children:"Deskripsi Usaha"}),e.jsx(S,{children:a.description}),e.jsx(Oe,{data:a,mutate:r}),t(["admin","manager"])&&e.jsxs(e.Fragment,{children:[e.jsx(D,{IconEl:je,children:"Lainnya"}),e.jsx(o,{colorScheme:"red",children:"Hapus Usaha"})]})]})]}):e.jsx(pe,{})}export{Ia as default};
